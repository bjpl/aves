import{j as e,q as S,e as E,d as k}from"./index-B9ZQskjr.js";import{r as c,c as z}from"./react-vendor-DDsanEFO.js";import{u as L}from"./useQuery-4LTe83CU.js";import{a as M}from"./apiAdapter-BXZis0fm.js";import"./index-ngrFHoWO.js";const j=({src:a,alt:i,className:d="",placeholder:r,blurAmount:m=20,threshold:l=.01,rootMargin:s="50px",onLoad:x,onError:h})=>{const[g,f]=c.useState(!1),[b,p]=c.useState(!1),[t,n]=c.useState(!1),u=c.useRef(null);c.useEffect(()=>{if(!u.current)return;const N=new IntersectionObserver(w=>{w.forEach(C=>{C.isIntersecting&&(p(!0),N.disconnect())})},{threshold:l,rootMargin:s});return N.observe(u.current),()=>{N.disconnect()}},[l,s]);const y=()=>{f(!0),x==null||x()},o=()=>{n(!0),h==null||h()},v=()=>r||"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 300'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:rgb(229,231,235);stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:rgb(209,213,219);stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='400' height='300' fill='url(%23grad)' /%3E%3C/svg%3E";return e.jsxs("div",{ref:u,className:`relative overflow-hidden ${d}`,style:{backgroundColor:"#e5e7eb"},children:[e.jsx("img",{src:v(),alt:"","aria-hidden":"true",className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-500 ${g?"opacity-0":"opacity-100"}`,style:{filter:`blur(${m}px)`,transform:"scale(1.1)"}}),b&&!t&&e.jsx("img",{src:a,alt:i,onLoad:y,onError:o,crossOrigin:"anonymous",className:`relative w-full h-full object-cover transition-opacity duration-500 ${g?"opacity-100":"opacity-0"}`,loading:"lazy"}),t&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-200",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("span",{className:"text-sm",children:"Image unavailable"})]})}),b&&!g&&!t&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]})},I=z.memo(({species:a,onClick:i,viewMode:d="grid"})=>{const r=l=>{switch(l){case"LC":return"bg-green-100 text-green-800";case"NT":return"bg-yellow-100 text-yellow-800";case"VU":return"bg-orange-100 text-orange-800";case"EN":return"bg-red-100 text-red-800";case"CR":return"bg-red-200 text-red-900";default:return"bg-gray-100 text-gray-800"}},m=l=>{switch(l){case"small":return"ðŸ¦";case"medium":return"ðŸ¦…";case"large":return"ðŸ¦¢";default:return"ðŸ¦œ"}};return d==="list"?e.jsxs("div",{onClick:()=>i==null?void 0:i(a),className:"flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-200",children:[a.primaryImageUrl?e.jsx(j,{src:a.primaryImageUrl,alt:a.spanishName,className:"w-16 h-16 rounded-lg",blurAmount:10}):e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center text-2xl",children:m(a.sizeCategory)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:a.spanishName}),e.jsx("p",{className:"text-sm text-gray-600",children:a.englishName}),e.jsx("p",{className:"text-xs text-gray-500 italic",children:a.scientificName})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:a.familyName}),a.conservationStatus&&e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r(a.conservationStatus)}`,children:a.conservationStatus})]}),e.jsx("div",{className:"flex gap-1",children:a.habitats.slice(0,2).map(l=>e.jsx("span",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded",children:l},l))})]}):e.jsxs("div",{onClick:()=>i==null?void 0:i(a),className:"bg-white rounded-lg shadow-md hover:shadow-xl transition-all cursor-pointer overflow-hidden group",children:[e.jsxs("div",{className:"aspect-square bg-gradient-to-br from-gray-200 to-gray-300 relative",children:[a.primaryImageUrl?e.jsx(j,{src:a.primaryImageUrl,alt:a.spanishName,className:"w-full h-full"}):e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-6xl opacity-50",children:m(a.sizeCategory)}),a.conservationStatus&&e.jsx("span",{className:`absolute top-2 right-2 text-xs px-2 py-1 rounded-full ${r(a.conservationStatus)}`,children:a.conservationStatus})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg group-hover:text-blue-600 transition-colors",children:a.spanishName}),e.jsx("p",{className:"text-sm text-gray-600",children:a.englishName}),e.jsx("p",{className:"text-xs text-gray-500 italic mt-1",children:a.scientificName}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-1",children:a.primaryColors.slice(0,3).map(l=>e.jsx("span",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:l},title:l},l))}),e.jsx("span",{className:"text-xs text-gray-500",children:a.familyName})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:a.habitats.slice(0,2).map(l=>e.jsx("span",{className:"text-xs bg-green-50 text-green-700 px-2 py-1 rounded",children:l},l))}),a.annotationCount!==void 0&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("p",{className:"text-xs text-gray-500",children:[a.annotationCount," annotations available"]})})]})]})}),H=({filters:a,onFilterChange:i,availableFilters:d})=>{const r=(s,x)=>{i({...a,[s]:x||void 0})},m=()=>{i({})},l=Object.values(a).filter(s=>s).length;return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Filters"}),l>0&&e.jsxs("button",{onClick:m,className:"text-sm text-blue-600 hover:text-blue-800",children:["Clear all (",l,")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsx("input",{type:"text",value:a.searchTerm||"",onChange:s=>r("searchTerm",s.target.value),placeholder:"Spanish or English name...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order"}),e.jsxs("select",{value:a.orderName||"",onChange:s=>r("orderName",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Orders"}),d.orders.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),a.orderName&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Family"}),e.jsxs("select",{value:a.familyName||"",onChange:s=>r("familyName",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Families"}),d.families.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),e.jsx("div",{className:"flex gap-2",children:["small","medium","large"].map(s=>e.jsx("button",{onClick:()=>r("sizeCategory",a.sizeCategory===s?null:s),className:`flex-1 px-3 py-2 rounded-md border text-sm capitalize transition-colors ${a.sizeCategory===s?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Habitat"}),e.jsxs("select",{value:a.habitat||"",onChange:s=>r("habitat",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Habitats"}),d.habitats.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Color"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:d.colors.map(s=>e.jsx("button",{onClick:()=>r("primaryColor",a.primaryColor===s?null:s),className:`w-full h-8 rounded border-2 transition-all ${a.primaryColor===s?"border-blue-500 ring-2 ring-blue-200":"border-gray-300 hover:border-gray-400"}`,style:{backgroundColor:s},title:s},s))})]})]})},$=a=>L({queryKey:S.species.list(a),queryFn:async()=>{try{return await M.species.list(a)}catch(i){return E("Error fetching species",i instanceof Error?i:new Error(String(i))),[]}},staleTime:10*60*1e3,gcTime:30*60*1e3,placeholderData:[]}),F=()=>{const{data:a=[],isLoading:i,error:d}=$(),[r,m]=c.useState({}),[l,s]=c.useState("grid"),x=c.useMemo(()=>{let t=[...a];if(r.searchTerm){const n=r.searchTerm.toLowerCase();t=t.filter(u=>u.spanishName.toLowerCase().includes(n)||u.englishName.toLowerCase().includes(n)||u.scientificName.toLowerCase().includes(n))}return r.orderName&&(t=t.filter(n=>n.orderName===r.orderName)),r.familyName&&(t=t.filter(n=>n.familyName===r.familyName)),r.sizeCategory&&(t=t.filter(n=>n.sizeCategory===r.sizeCategory)),r.habitat&&(t=t.filter(n=>n.habitats.includes(r.habitat))),r.primaryColor&&(t=t.filter(n=>n.primaryColors.includes(r.primaryColor))),t},[a,r]),h=c.useMemo(()=>{const t=[...new Set(a.map(o=>o.orderName))].sort(),n=r.orderName?[...new Set(a.filter(o=>o.orderName===r.orderName).map(o=>o.familyName))].sort():[...new Set(a.map(o=>o.familyName))].sort(),u=[...new Set(a.flatMap(o=>o.habitats))].sort(),y=[...new Set(a.flatMap(o=>o.primaryColors))].sort();return{orders:t,families:n,habitats:u,colors:y}},[a,r.orderName]),g=c.useCallback(t=>{k("Selected species:",{name:t.spanishName})},[]),f=c.useCallback(t=>{m(t)},[]),b=c.useCallback(t=>{s(t)},[]),p=c.useCallback(()=>{m({})},[]);return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading species..."})}):d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-red-500",children:["Error loading species: ",d instanceof Error?d.message:"Unknown error"]})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Species Browser"}),e.jsxs("p",{className:"text-gray-600",children:["Explore ",a.length," bird species with Spanish vocabulary"]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"w-64 flex-shrink-0",children:e.jsx(H,{filters:r,onFilterChange:f,availableFilters:h})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",x.length," of ",a.length," species"]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>b("grid"),className:`p-2 rounded ${l==="grid"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,"aria-label":"Grid view",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM13 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2h-2z"})})}),e.jsx("button",{onClick:()=>b("list"),className:`p-2 rounded ${l==="list"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,"aria-label":"List view",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})})]}),x.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[e.jsx("p",{className:"text-gray-500",children:"No species found matching your filters."}),e.jsx("button",{onClick:p,className:"mt-4 text-blue-600 hover:text-blue-800",children:"Clear filters"})]}):e.jsx("div",{className:l==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-4",children:x.map(t=>e.jsx(I,{species:t,onClick:g,viewMode:l},t.id))})]})]})]})},q=()=>e.jsx(F,{});export{q as SpeciesPage};

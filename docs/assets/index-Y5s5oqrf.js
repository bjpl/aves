var Pt=Object.defineProperty;var Dt=(t,e,s)=>e in t?Pt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var J=(t,e,s)=>Dt(t,typeof e!="symbol"?e+"":e,s);import{r as b,a as It,L as q,B as _t,R as Mt,b as he,c as Bt}from"./react-vendor-BPIYoGmp.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}})();var at={exports:{}},be={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ft=b,Ut=Symbol.for("react.element"),zt=Symbol.for("react.fragment"),$t=Object.prototype.hasOwnProperty,Ht=Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qt={key:!0,ref:!0,__self:!0,__source:!0};function it(t,e,s){var r,a={},o=null,i=null;s!==void 0&&(o=""+s),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)$t.call(e,r)&&!qt.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:Ut,type:t,key:o,ref:i,props:a,_owner:Ht.current}}be.Fragment=zt;be.jsx=it;be.jsxs=it;at.exports=be;var n=at.exports,ke={},ze=It;ke.createRoot=ze.createRoot,ke.hydrateRoot=ze.hydrateRoot;class Vt{constructor(){J(this,"dbName","aves-learning-db");J(this,"dbVersion",1);J(this,"db",null);J(this,"staticData",{annotations:[],species:[],exercises:[]})}async initialize(){await this.loadStaticData(),await this.initIndexedDB(),this.migrateLocalStorage()}async loadStaticData(){try{const e="/",s=await fetch(`${e}data/annotations.json`);this.staticData.annotations=await s.json();const r=await fetch(`${e}data/species.json`);this.staticData.species=await r.json();try{const a=await fetch(`${e}data/exercises.json`);this.staticData.exercises=await a.json()}catch{this.staticData.exercises=[]}}catch(e){console.error("Failed to load static data:",e),this.loadEmbeddedData()}}loadEmbeddedData(){this.staticData.annotations=[{id:"1",imageId:"cardinal-1",boundingBox:{topLeft:{x:150,y:100},bottomRight:{x:250,y:150},width:100,height:50},type:"anatomical",spanishTerm:"pico",englishTerm:"beak",pronunciation:"PEE-koh",difficultyLevel:1,isVisible:!0,createdAt:new Date,updatedAt:new Date},{id:"2",imageId:"cardinal-1",boundingBox:{topLeft:{x:200,y:150},bottomRight:{x:280,y:200},width:80,height:50},type:"color",spanishTerm:"plumas rojas",englishTerm:"red feathers",pronunciation:"PLOO-mahs ROH-hahs",difficultyLevel:2,isVisible:!0,createdAt:new Date,updatedAt:new Date}],this.staticData.species=[{id:"1",scientificName:"Cardinalis cardinalis",englishName:"Northern Cardinal",spanishName:"Cardenal Rojo",orderName:"Passeriformes",familyName:"Cardinalidae",genus:"Cardinalis",habitats:["forest","urban"],sizeCategory:"medium",primaryColors:["red","black"],conservationStatus:"LC",primaryImageUrl:"https://images.unsplash.com/photo-1551031895-7f8e06d714f8?w=400",descriptionSpanish:"Ave distintiva de color rojo brillante con cresta prominente.",descriptionEnglish:"Distinctive bright red bird with prominent crest.",funFact:"Cardinals are one of the few bird species where both males and females sing.",annotationCount:2}]}async initIndexedDB(){return new Promise((e,s)=>{const r=indexedDB.open(this.dbName,this.dbVersion);r.onerror=()=>{console.error("Failed to open IndexedDB"),s(r.error)},r.onsuccess=()=>{this.db=r.result,e()},r.onupgradeneeded=a=>{const o=a.target.result;if(!o.objectStoreNames.contains("interactions")){const i=o.createObjectStore("interactions",{keyPath:"id",autoIncrement:!0});i.createIndex("annotationId","annotationId",{unique:!1}),i.createIndex("timestamp","timestamp",{unique:!1})}if(o.objectStoreNames.contains("progress")||o.createObjectStore("progress",{keyPath:"sessionId"}).createIndex("lastUpdated","lastUpdated",{unique:!1}),!o.objectStoreNames.contains("exerciseResults")){const i=o.createObjectStore("exerciseResults",{keyPath:"id",autoIncrement:!0});i.createIndex("exerciseId","exerciseId",{unique:!1}),i.createIndex("completedAt","completedAt",{unique:!1})}}})}migrateLocalStorage(){const e=localStorage.getItem("aves-progress");if(e)try{const s=JSON.parse(e);this.saveProgress(s),localStorage.removeItem("aves-progress")}catch(s){console.error("Failed to migrate localStorage:",s)}}async getAnnotations(e){return e?this.staticData.annotations.filter(s=>s.imageId===e):this.staticData.annotations}async getSpecies(e){let s=[...this.staticData.species];return e&&(e.habitat&&(s=s.filter(r=>r.habitats.includes(e.habitat))),e.sizeCategory&&(s=s.filter(r=>r.sizeCategory===e.sizeCategory)),e.primaryColor&&(s=s.filter(r=>r.primaryColors.includes(e.primaryColor)))),s}async getExercises(e){return e?this.staticData.exercises.filter(s=>s.type===e):this.staticData.exercises}async saveInteraction(e){if(!this.db)throw new Error("Database not initialized");const r=this.db.transaction(["interactions"],"readwrite").objectStore("interactions");await new Promise((a,o)=>{const i=r.add({...e,timestamp:new Date});i.onsuccess=()=>a(i.result),i.onerror=()=>o(i.error)})}async getInteractions(e){if(!this.db)throw new Error("Database not initialized");const r=this.db.transaction(["interactions"],"readonly").objectStore("interactions");return new Promise((a,o)=>{const i=r.getAll();i.onsuccess=()=>{const d=i.result.filter(p=>p.userSessionId===e);a(d)},i.onerror=()=>o(i.error)})}async saveProgress(e){if(!this.db){localStorage.setItem("aves-progress-backup",JSON.stringify(e));return}const r=this.db.transaction(["progress"],"readwrite").objectStore("progress");await new Promise((a,o)=>{const i=r.put({...e,lastUpdated:new Date});i.onsuccess=()=>a(i.result),i.onerror=()=>o(i.error)})}async getProgress(e){if(!this.db){const a=localStorage.getItem("aves-progress-backup");return a?JSON.parse(a):null}const r=this.db.transaction(["progress"],"readonly").objectStore("progress");return new Promise((a,o)=>{const i=r.get(e);i.onsuccess=()=>a(i.result),i.onerror=()=>o(i.error)})}async saveExerciseResult(e){if(!this.db)throw new Error("Database not initialized");const r=this.db.transaction(["exerciseResults"],"readwrite").objectStore("exerciseResults");await new Promise((a,o)=>{const i=r.add({...e,completedAt:new Date});i.onsuccess=()=>a(i.result),i.onerror=()=>o(i.error)})}async getExerciseResults(e){if(!this.db)throw new Error("Database not initialized");const r=this.db.transaction(["exerciseResults"],"readonly").objectStore("exerciseResults");return new Promise((a,o)=>{const i=r.getAll();i.onsuccess=()=>{const d=i.result.filter(p=>p.sessionId===e);a(d)},i.onerror=()=>o(i.error)})}async exportData(){const e={interactions:await this.getInteractions(this.getCurrentSessionId()),progress:await this.getProgress(this.getCurrentSessionId()),exerciseResults:await this.getExerciseResults(this.getCurrentSessionId()),exportedAt:new Date().toISOString()};return JSON.stringify(e,null,2)}async importData(e){try{const s=JSON.parse(e);if(s.interactions)for(const r of s.interactions)await this.saveInteraction(r);if(s.progress&&await this.saveProgress(s.progress),s.exerciseResults)for(const r of s.exerciseResults)await this.saveExerciseResult(r)}catch(s){throw console.error("Failed to import data:",s),new Error("Invalid import data format")}}getCurrentSessionId(){let e=sessionStorage.getItem("aves-session-id");return e||(e=`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,sessionStorage.setItem("aves-session-id",e)),e}async clearAllData(){if(this.db){const e=this.db.transaction(["interactions","progress","exerciseResults"],"readwrite");await Promise.all([this.clearObjectStore(e,"interactions"),this.clearObjectStore(e,"progress"),this.clearObjectStore(e,"exerciseResults")])}localStorage.clear(),sessionStorage.clear()}clearObjectStore(e,s){return new Promise((r,a)=>{const i=e.objectStore(s).clear();i.onsuccess=()=>r(),i.onerror=()=>a(i.error)})}}const I=new Vt;I.initialize().catch(console.error);function ot(t,e){return function(){return t.apply(e,arguments)}}const{toString:Wt}=Object.prototype,{getPrototypeOf:_e}=Object,{iterator:ye,toStringTag:lt}=Symbol,we=(t=>e=>{const s=Wt.call(e);return t[s]||(t[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),V=t=>(t=t.toLowerCase(),e=>we(e)===t),je=t=>e=>typeof e===t,{isArray:te}=Array,ee=je("undefined");function ie(t){return t!==null&&!ee(t)&&t.constructor!==null&&!ee(t.constructor)&&F(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const ct=V("ArrayBuffer");function Jt(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&ct(t.buffer),e}const Kt=je("string"),F=je("function"),dt=je("number"),oe=t=>t!==null&&typeof t=="object",Xt=t=>t===!0||t===!1,fe=t=>{if(we(t)!=="object")return!1;const e=_e(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(lt in t)&&!(ye in t)},Gt=t=>{if(!oe(t)||ie(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},Yt=V("Date"),Qt=V("File"),Zt=V("Blob"),es=V("FileList"),ts=t=>oe(t)&&F(t.pipe),ss=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||F(t.append)&&((e=we(t))==="formdata"||e==="object"&&F(t.toString)&&t.toString()==="[object FormData]"))},rs=V("URLSearchParams"),[ns,as,is,os]=["ReadableStream","Request","Response","Headers"].map(V),ls=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function le(t,e,{allOwnKeys:s=!1}={}){if(t===null||typeof t>"u")return;let r,a;if(typeof t!="object"&&(t=[t]),te(t))for(r=0,a=t.length;r<a;r++)e.call(null,t[r],r,t);else{if(ie(t))return;const o=s?Object.getOwnPropertyNames(t):Object.keys(t),i=o.length;let d;for(r=0;r<i;r++)d=o[r],e.call(null,t[d],d,t)}}function ut(t,e){if(ie(t))return null;e=e.toLowerCase();const s=Object.keys(t);let r=s.length,a;for(;r-- >0;)if(a=s[r],e===a.toLowerCase())return a;return null}const G=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ht=t=>!ee(t)&&t!==G;function Le(){const{caseless:t,skipUndefined:e}=ht(this)&&this||{},s={},r=(a,o)=>{const i=t&&ut(s,o)||o;fe(s[i])&&fe(a)?s[i]=Le(s[i],a):fe(a)?s[i]=Le({},a):te(a)?s[i]=a.slice():(!e||!ee(a))&&(s[i]=a)};for(let a=0,o=arguments.length;a<o;a++)arguments[a]&&le(arguments[a],r);return s}const cs=(t,e,s,{allOwnKeys:r}={})=>(le(e,(a,o)=>{s&&F(a)?t[o]=ot(a,s):t[o]=a},{allOwnKeys:r}),t),ds=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),us=(t,e,s,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),s&&Object.assign(t.prototype,s)},hs=(t,e,s,r)=>{let a,o,i;const d={};if(e=e||{},t==null)return e;do{for(a=Object.getOwnPropertyNames(t),o=a.length;o-- >0;)i=a[o],(!r||r(i,t,e))&&!d[i]&&(e[i]=t[i],d[i]=!0);t=s!==!1&&_e(t)}while(t&&(!s||s(t,e))&&t!==Object.prototype);return e},ms=(t,e,s)=>{t=String(t),(s===void 0||s>t.length)&&(s=t.length),s-=e.length;const r=t.indexOf(e,s);return r!==-1&&r===s},fs=t=>{if(!t)return null;if(te(t))return t;let e=t.length;if(!dt(e))return null;const s=new Array(e);for(;e-- >0;)s[e]=t[e];return s},ps=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&_e(Uint8Array)),gs=(t,e)=>{const r=(t&&t[ye]).call(t);let a;for(;(a=r.next())&&!a.done;){const o=a.value;e.call(t,o[0],o[1])}},xs=(t,e)=>{let s;const r=[];for(;(s=t.exec(e))!==null;)r.push(s);return r},bs=V("HTMLFormElement"),ys=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,r,a){return r.toUpperCase()+a}),$e=(({hasOwnProperty:t})=>(e,s)=>t.call(e,s))(Object.prototype),ws=V("RegExp"),mt=(t,e)=>{const s=Object.getOwnPropertyDescriptors(t),r={};le(s,(a,o)=>{let i;(i=e(a,o,t))!==!1&&(r[o]=i||a)}),Object.defineProperties(t,r)},js=t=>{mt(t,(e,s)=>{if(F(t)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const r=t[s];if(F(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},vs=(t,e)=>{const s={},r=a=>{a.forEach(o=>{s[o]=!0})};return te(t)?r(t):r(String(t).split(e)),s},Ns=()=>{},Ss=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function Es(t){return!!(t&&F(t.append)&&t[lt]==="FormData"&&t[ye])}const Cs=t=>{const e=new Array(10),s=(r,a)=>{if(oe(r)){if(e.indexOf(r)>=0)return;if(ie(r))return r;if(!("toJSON"in r)){e[a]=r;const o=te(r)?[]:{};return le(r,(i,d)=>{const p=s(i,a+1);!ee(p)&&(o[d]=p)}),e[a]=void 0,o}}return r};return s(t,0)},As=V("AsyncFunction"),Ts=t=>t&&(oe(t)||F(t))&&F(t.then)&&F(t.catch),ft=((t,e)=>t?setImmediate:e?((s,r)=>(G.addEventListener("message",({source:a,data:o})=>{a===G&&o===s&&r.length&&r.shift()()},!1),a=>{r.push(a),G.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",F(G.postMessage)),Rs=typeof queueMicrotask<"u"?queueMicrotask.bind(G):typeof process<"u"&&process.nextTick||ft,ks=t=>t!=null&&F(t[ye]),u={isArray:te,isArrayBuffer:ct,isBuffer:ie,isFormData:ss,isArrayBufferView:Jt,isString:Kt,isNumber:dt,isBoolean:Xt,isObject:oe,isPlainObject:fe,isEmptyObject:Gt,isReadableStream:ns,isRequest:as,isResponse:is,isHeaders:os,isUndefined:ee,isDate:Yt,isFile:Qt,isBlob:Zt,isRegExp:ws,isFunction:F,isStream:ts,isURLSearchParams:rs,isTypedArray:ps,isFileList:es,forEach:le,merge:Le,extend:cs,trim:ls,stripBOM:ds,inherits:us,toFlatObject:hs,kindOf:we,kindOfTest:V,endsWith:ms,toArray:fs,forEachEntry:gs,matchAll:xs,isHTMLForm:bs,hasOwnProperty:$e,hasOwnProp:$e,reduceDescriptors:mt,freezeMethods:js,toObjectSet:vs,toCamelCase:ys,noop:Ns,toFiniteNumber:Ss,findKey:ut,global:G,isContextDefined:ht,isSpecCompliantForm:Es,toJSONObject:Cs,isAsyncFn:As,isThenable:Ts,setImmediate:ft,asap:Rs,isIterable:ks};function N(t,e,s,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),s&&(this.config=s),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}u.inherits(N,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:u.toJSONObject(this.config),code:this.code,status:this.status}}});const pt=N.prototype,gt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{gt[t]={value:t}});Object.defineProperties(N,gt);Object.defineProperty(pt,"isAxiosError",{value:!0});N.from=(t,e,s,r,a,o)=>{const i=Object.create(pt);u.toFlatObject(t,i,function(l){return l!==Error.prototype},h=>h!=="isAxiosError");const d=t&&t.message?t.message:"Error",p=e==null&&t?t.code:e;return N.call(i,d,p,s,r,a),t&&i.cause==null&&Object.defineProperty(i,"cause",{value:t,configurable:!0}),i.name=t&&t.name||"Error",o&&Object.assign(i,o),i};const Ls=null;function Oe(t){return u.isPlainObject(t)||u.isArray(t)}function xt(t){return u.endsWith(t,"[]")?t.slice(0,-2):t}function He(t,e,s){return t?t.concat(e).map(function(a,o){return a=xt(a),!s&&o?"["+a+"]":a}).join(s?".":""):e}function Os(t){return u.isArray(t)&&!t.some(Oe)}const Ps=u.toFlatObject(u,{},null,function(e){return/^is[A-Z]/.test(e)});function ve(t,e,s){if(!u.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,s=u.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,g){return!u.isUndefined(g[x])});const r=s.metaTokens,a=s.visitor||l,o=s.dots,i=s.indexes,p=(s.Blob||typeof Blob<"u"&&Blob)&&u.isSpecCompliantForm(e);if(!u.isFunction(a))throw new TypeError("visitor must be a function");function h(m){if(m===null)return"";if(u.isDate(m))return m.toISOString();if(u.isBoolean(m))return m.toString();if(!p&&u.isBlob(m))throw new N("Blob is not supported. Use a Buffer instead.");return u.isArrayBuffer(m)||u.isTypedArray(m)?p&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function l(m,x,g){let S=m;if(m&&!g&&typeof m=="object"){if(u.endsWith(x,"{}"))x=r?x:x.slice(0,-2),m=JSON.stringify(m);else if(u.isArray(m)&&Os(m)||(u.isFileList(m)||u.endsWith(x,"[]"))&&(S=u.toArray(m)))return x=xt(x),S.forEach(function(C,T){!(u.isUndefined(C)||C===null)&&e.append(i===!0?He([x],T,o):i===null?x:x+"[]",h(C))}),!1}return Oe(m)?!0:(e.append(He(g,x,o),h(m)),!1)}const c=[],f=Object.assign(Ps,{defaultVisitor:l,convertValue:h,isVisitable:Oe});function y(m,x){if(!u.isUndefined(m)){if(c.indexOf(m)!==-1)throw Error("Circular reference detected in "+x.join("."));c.push(m),u.forEach(m,function(S,w){(!(u.isUndefined(S)||S===null)&&a.call(e,S,u.isString(w)?w.trim():w,x,f))===!0&&y(S,x?x.concat(w):[w])}),c.pop()}}if(!u.isObject(t))throw new TypeError("data must be an object");return y(t),e}function qe(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Me(t,e){this._pairs=[],t&&ve(t,this,e)}const bt=Me.prototype;bt.append=function(e,s){this._pairs.push([e,s])};bt.toString=function(e){const s=e?function(r){return e.call(this,r,qe)}:qe;return this._pairs.map(function(a){return s(a[0])+"="+s(a[1])},"").join("&")};function Ds(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function yt(t,e,s){if(!e)return t;const r=s&&s.encode||Ds;u.isFunction(s)&&(s={serialize:s});const a=s&&s.serialize;let o;if(a?o=a(e,s):o=u.isURLSearchParams(e)?e.toString():new Me(e,s).toString(r),o){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class Ve{constructor(){this.handlers=[]}use(e,s,r){return this.handlers.push({fulfilled:e,rejected:s,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){u.forEach(this.handlers,function(r){r!==null&&e(r)})}}const wt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Is=typeof URLSearchParams<"u"?URLSearchParams:Me,_s=typeof FormData<"u"?FormData:null,Ms=typeof Blob<"u"?Blob:null,Bs={isBrowser:!0,classes:{URLSearchParams:Is,FormData:_s,Blob:Ms},protocols:["http","https","file","blob","url","data"]},Be=typeof window<"u"&&typeof document<"u",Pe=typeof navigator=="object"&&navigator||void 0,Fs=Be&&(!Pe||["ReactNative","NativeScript","NS"].indexOf(Pe.product)<0),Us=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",zs=Be&&window.location.href||"http://localhost",$s=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Be,hasStandardBrowserEnv:Fs,hasStandardBrowserWebWorkerEnv:Us,navigator:Pe,origin:zs},Symbol.toStringTag,{value:"Module"})),_={...$s,...Bs};function Hs(t,e){return ve(t,new _.classes.URLSearchParams,{visitor:function(s,r,a,o){return _.isNode&&u.isBuffer(s)?(this.append(r,s.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...e})}function qs(t){return u.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Vs(t){const e={},s=Object.keys(t);let r;const a=s.length;let o;for(r=0;r<a;r++)o=s[r],e[o]=t[o];return e}function jt(t){function e(s,r,a,o){let i=s[o++];if(i==="__proto__")return!0;const d=Number.isFinite(+i),p=o>=s.length;return i=!i&&u.isArray(a)?a.length:i,p?(u.hasOwnProp(a,i)?a[i]=[a[i],r]:a[i]=r,!d):((!a[i]||!u.isObject(a[i]))&&(a[i]=[]),e(s,r,a[i],o)&&u.isArray(a[i])&&(a[i]=Vs(a[i])),!d)}if(u.isFormData(t)&&u.isFunction(t.entries)){const s={};return u.forEachEntry(t,(r,a)=>{e(qs(r),a,s,0)}),s}return null}function Ws(t,e,s){if(u.isString(t))try{return(e||JSON.parse)(t),u.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(s||JSON.stringify)(t)}const ce={transitional:wt,adapter:["xhr","http","fetch"],transformRequest:[function(e,s){const r=s.getContentType()||"",a=r.indexOf("application/json")>-1,o=u.isObject(e);if(o&&u.isHTMLForm(e)&&(e=new FormData(e)),u.isFormData(e))return a?JSON.stringify(jt(e)):e;if(u.isArrayBuffer(e)||u.isBuffer(e)||u.isStream(e)||u.isFile(e)||u.isBlob(e)||u.isReadableStream(e))return e;if(u.isArrayBufferView(e))return e.buffer;if(u.isURLSearchParams(e))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let d;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Hs(e,this.formSerializer).toString();if((d=u.isFileList(e))||r.indexOf("multipart/form-data")>-1){const p=this.env&&this.env.FormData;return ve(d?{"files[]":e}:e,p&&new p,this.formSerializer)}}return o||a?(s.setContentType("application/json",!1),Ws(e)):e}],transformResponse:[function(e){const s=this.transitional||ce.transitional,r=s&&s.forcedJSONParsing,a=this.responseType==="json";if(u.isResponse(e)||u.isReadableStream(e))return e;if(e&&u.isString(e)&&(r&&!this.responseType||a)){const i=!(s&&s.silentJSONParsing)&&a;try{return JSON.parse(e,this.parseReviver)}catch(d){if(i)throw d.name==="SyntaxError"?N.from(d,N.ERR_BAD_RESPONSE,this,null,this.response):d}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:_.classes.FormData,Blob:_.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};u.forEach(["delete","get","head","post","put","patch"],t=>{ce.headers[t]={}});const Js=u.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ks=t=>{const e={};let s,r,a;return t&&t.split(`
`).forEach(function(i){a=i.indexOf(":"),s=i.substring(0,a).trim().toLowerCase(),r=i.substring(a+1).trim(),!(!s||e[s]&&Js[s])&&(s==="set-cookie"?e[s]?e[s].push(r):e[s]=[r]:e[s]=e[s]?e[s]+", "+r:r)}),e},We=Symbol("internals");function ae(t){return t&&String(t).trim().toLowerCase()}function pe(t){return t===!1||t==null?t:u.isArray(t)?t.map(pe):String(t)}function Xs(t){const e=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=s.exec(t);)e[r[1]]=r[2];return e}const Gs=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Ee(t,e,s,r,a){if(u.isFunction(r))return r.call(this,e,s);if(a&&(e=s),!!u.isString(e)){if(u.isString(r))return e.indexOf(r)!==-1;if(u.isRegExp(r))return r.test(e)}}function Ys(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,s,r)=>s.toUpperCase()+r)}function Qs(t,e){const s=u.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+s,{value:function(a,o,i){return this[r].call(this,e,a,o,i)},configurable:!0})})}let U=class{constructor(e){e&&this.set(e)}set(e,s,r){const a=this;function o(d,p,h){const l=ae(p);if(!l)throw new Error("header name must be a non-empty string");const c=u.findKey(a,l);(!c||a[c]===void 0||h===!0||h===void 0&&a[c]!==!1)&&(a[c||p]=pe(d))}const i=(d,p)=>u.forEach(d,(h,l)=>o(h,l,p));if(u.isPlainObject(e)||e instanceof this.constructor)i(e,s);else if(u.isString(e)&&(e=e.trim())&&!Gs(e))i(Ks(e),s);else if(u.isObject(e)&&u.isIterable(e)){let d={},p,h;for(const l of e){if(!u.isArray(l))throw TypeError("Object iterator must return a key-value pair");d[h=l[0]]=(p=d[h])?u.isArray(p)?[...p,l[1]]:[p,l[1]]:l[1]}i(d,s)}else e!=null&&o(s,e,r);return this}get(e,s){if(e=ae(e),e){const r=u.findKey(this,e);if(r){const a=this[r];if(!s)return a;if(s===!0)return Xs(a);if(u.isFunction(s))return s.call(this,a,r);if(u.isRegExp(s))return s.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,s){if(e=ae(e),e){const r=u.findKey(this,e);return!!(r&&this[r]!==void 0&&(!s||Ee(this,this[r],r,s)))}return!1}delete(e,s){const r=this;let a=!1;function o(i){if(i=ae(i),i){const d=u.findKey(r,i);d&&(!s||Ee(r,r[d],d,s))&&(delete r[d],a=!0)}}return u.isArray(e)?e.forEach(o):o(e),a}clear(e){const s=Object.keys(this);let r=s.length,a=!1;for(;r--;){const o=s[r];(!e||Ee(this,this[o],o,e,!0))&&(delete this[o],a=!0)}return a}normalize(e){const s=this,r={};return u.forEach(this,(a,o)=>{const i=u.findKey(r,o);if(i){s[i]=pe(a),delete s[o];return}const d=e?Ys(o):String(o).trim();d!==o&&delete s[o],s[d]=pe(a),r[d]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const s=Object.create(null);return u.forEach(this,(r,a)=>{r!=null&&r!==!1&&(s[a]=e&&u.isArray(r)?r.join(", "):r)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,s])=>e+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...s){const r=new this(e);return s.forEach(a=>r.set(a)),r}static accessor(e){const r=(this[We]=this[We]={accessors:{}}).accessors,a=this.prototype;function o(i){const d=ae(i);r[d]||(Qs(a,i),r[d]=!0)}return u.isArray(e)?e.forEach(o):o(e),this}};U.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);u.reduceDescriptors(U.prototype,({value:t},e)=>{let s=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[s]=r}}});u.freezeMethods(U);function Ce(t,e){const s=this||ce,r=e||s,a=U.from(r.headers);let o=r.data;return u.forEach(t,function(d){o=d.call(s,o,a.normalize(),e?e.status:void 0)}),a.normalize(),o}function vt(t){return!!(t&&t.__CANCEL__)}function se(t,e,s){N.call(this,t??"canceled",N.ERR_CANCELED,e,s),this.name="CanceledError"}u.inherits(se,N,{__CANCEL__:!0});function Nt(t,e,s){const r=s.config.validateStatus;!s.status||!r||r(s.status)?t(s):e(new N("Request failed with status code "+s.status,[N.ERR_BAD_REQUEST,N.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function Zs(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function er(t,e){t=t||10;const s=new Array(t),r=new Array(t);let a=0,o=0,i;return e=e!==void 0?e:1e3,function(p){const h=Date.now(),l=r[o];i||(i=h),s[a]=p,r[a]=h;let c=o,f=0;for(;c!==a;)f+=s[c++],c=c%t;if(a=(a+1)%t,a===o&&(o=(o+1)%t),h-i<e)return;const y=l&&h-l;return y?Math.round(f*1e3/y):void 0}}function tr(t,e){let s=0,r=1e3/e,a,o;const i=(h,l=Date.now())=>{s=l,a=null,o&&(clearTimeout(o),o=null),t(...h)};return[(...h)=>{const l=Date.now(),c=l-s;c>=r?i(h,l):(a=h,o||(o=setTimeout(()=>{o=null,i(a)},r-c)))},()=>a&&i(a)]}const xe=(t,e,s=3)=>{let r=0;const a=er(50,250);return tr(o=>{const i=o.loaded,d=o.lengthComputable?o.total:void 0,p=i-r,h=a(p),l=i<=d;r=i;const c={loaded:i,total:d,progress:d?i/d:void 0,bytes:p,rate:h||void 0,estimated:h&&d&&l?(d-i)/h:void 0,event:o,lengthComputable:d!=null,[e?"download":"upload"]:!0};t(c)},s)},Je=(t,e)=>{const s=t!=null;return[r=>e[0]({lengthComputable:s,total:t,loaded:r}),e[1]]},Ke=t=>(...e)=>u.asap(()=>t(...e)),sr=_.hasStandardBrowserEnv?((t,e)=>s=>(s=new URL(s,_.origin),t.protocol===s.protocol&&t.host===s.host&&(e||t.port===s.port)))(new URL(_.origin),_.navigator&&/(msie|trident)/i.test(_.navigator.userAgent)):()=>!0,rr=_.hasStandardBrowserEnv?{write(t,e,s,r,a,o){const i=[t+"="+encodeURIComponent(e)];u.isNumber(s)&&i.push("expires="+new Date(s).toGMTString()),u.isString(r)&&i.push("path="+r),u.isString(a)&&i.push("domain="+a),o===!0&&i.push("secure"),document.cookie=i.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function nr(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function ar(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function St(t,e,s){let r=!nr(e);return t&&(r||s==!1)?ar(t,e):e}const Xe=t=>t instanceof U?{...t}:t;function Q(t,e){e=e||{};const s={};function r(h,l,c,f){return u.isPlainObject(h)&&u.isPlainObject(l)?u.merge.call({caseless:f},h,l):u.isPlainObject(l)?u.merge({},l):u.isArray(l)?l.slice():l}function a(h,l,c,f){if(u.isUndefined(l)){if(!u.isUndefined(h))return r(void 0,h,c,f)}else return r(h,l,c,f)}function o(h,l){if(!u.isUndefined(l))return r(void 0,l)}function i(h,l){if(u.isUndefined(l)){if(!u.isUndefined(h))return r(void 0,h)}else return r(void 0,l)}function d(h,l,c){if(c in e)return r(h,l);if(c in t)return r(void 0,h)}const p={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:d,headers:(h,l,c)=>a(Xe(h),Xe(l),c,!0)};return u.forEach(Object.keys({...t,...e}),function(l){const c=p[l]||a,f=c(t[l],e[l],l);u.isUndefined(f)&&c!==d||(s[l]=f)}),s}const Et=t=>{const e=Q({},t);let{data:s,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:o,headers:i,auth:d}=e;if(e.headers=i=U.from(i),e.url=yt(St(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),d&&i.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),u.isFormData(s)){if(_.hasStandardBrowserEnv||_.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(u.isFunction(s.getHeaders)){const p=s.getHeaders(),h=["content-type","content-length"];Object.entries(p).forEach(([l,c])=>{h.includes(l.toLowerCase())&&i.set(l,c)})}}if(_.hasStandardBrowserEnv&&(r&&u.isFunction(r)&&(r=r(e)),r||r!==!1&&sr(e.url))){const p=a&&o&&rr.read(o);p&&i.set(a,p)}return e},ir=typeof XMLHttpRequest<"u",or=ir&&function(t){return new Promise(function(s,r){const a=Et(t);let o=a.data;const i=U.from(a.headers).normalize();let{responseType:d,onUploadProgress:p,onDownloadProgress:h}=a,l,c,f,y,m;function x(){y&&y(),m&&m(),a.cancelToken&&a.cancelToken.unsubscribe(l),a.signal&&a.signal.removeEventListener("abort",l)}let g=new XMLHttpRequest;g.open(a.method.toUpperCase(),a.url,!0),g.timeout=a.timeout;function S(){if(!g)return;const C=U.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),R={data:!d||d==="text"||d==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:C,config:t,request:g};Nt(function(L){s(L),x()},function(L){r(L),x()},R),g=null}"onloadend"in g?g.onloadend=S:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(S)},g.onabort=function(){g&&(r(new N("Request aborted",N.ECONNABORTED,t,g)),g=null)},g.onerror=function(T){const R=T&&T.message?T.message:"Network Error",M=new N(R,N.ERR_NETWORK,t,g);M.event=T||null,r(M),g=null},g.ontimeout=function(){let T=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const R=a.transitional||wt;a.timeoutErrorMessage&&(T=a.timeoutErrorMessage),r(new N(T,R.clarifyTimeoutError?N.ETIMEDOUT:N.ECONNABORTED,t,g)),g=null},o===void 0&&i.setContentType(null),"setRequestHeader"in g&&u.forEach(i.toJSON(),function(T,R){g.setRequestHeader(R,T)}),u.isUndefined(a.withCredentials)||(g.withCredentials=!!a.withCredentials),d&&d!=="json"&&(g.responseType=a.responseType),h&&([f,m]=xe(h,!0),g.addEventListener("progress",f)),p&&g.upload&&([c,y]=xe(p),g.upload.addEventListener("progress",c),g.upload.addEventListener("loadend",y)),(a.cancelToken||a.signal)&&(l=C=>{g&&(r(!C||C.type?new se(null,t,g):C),g.abort(),g=null)},a.cancelToken&&a.cancelToken.subscribe(l),a.signal&&(a.signal.aborted?l():a.signal.addEventListener("abort",l)));const w=Zs(a.url);if(w&&_.protocols.indexOf(w)===-1){r(new N("Unsupported protocol "+w+":",N.ERR_BAD_REQUEST,t));return}g.send(o||null)})},lr=(t,e)=>{const{length:s}=t=t?t.filter(Boolean):[];if(e||s){let r=new AbortController,a;const o=function(h){if(!a){a=!0,d();const l=h instanceof Error?h:this.reason;r.abort(l instanceof N?l:new se(l instanceof Error?l.message:l))}};let i=e&&setTimeout(()=>{i=null,o(new N(`timeout ${e} of ms exceeded`,N.ETIMEDOUT))},e);const d=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(h=>{h.unsubscribe?h.unsubscribe(o):h.removeEventListener("abort",o)}),t=null)};t.forEach(h=>h.addEventListener("abort",o));const{signal:p}=r;return p.unsubscribe=()=>u.asap(d),p}},cr=function*(t,e){let s=t.byteLength;if(s<e){yield t;return}let r=0,a;for(;r<s;)a=r+e,yield t.slice(r,a),r=a},dr=async function*(t,e){for await(const s of ur(t))yield*cr(s,e)},ur=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:s,value:r}=await e.read();if(s)break;yield r}}finally{await e.cancel()}},Ge=(t,e,s,r)=>{const a=dr(t,e);let o=0,i,d=p=>{i||(i=!0,r&&r(p))};return new ReadableStream({async pull(p){try{const{done:h,value:l}=await a.next();if(h){d(),p.close();return}let c=l.byteLength;if(s){let f=o+=c;s(f)}p.enqueue(new Uint8Array(l))}catch(h){throw d(h),h}},cancel(p){return d(p),a.return()}},{highWaterMark:2})},Ye=64*1024,{isFunction:me}=u,hr=(({Request:t,Response:e})=>({Request:t,Response:e}))(u.global),{ReadableStream:Qe,TextEncoder:Ze}=u.global,et=(t,...e)=>{try{return!!t(...e)}catch{return!1}},mr=t=>{t=u.merge.call({skipUndefined:!0},hr,t);const{fetch:e,Request:s,Response:r}=t,a=e?me(e):typeof fetch=="function",o=me(s),i=me(r);if(!a)return!1;const d=a&&me(Qe),p=a&&(typeof Ze=="function"?(m=>x=>m.encode(x))(new Ze):async m=>new Uint8Array(await new s(m).arrayBuffer())),h=o&&d&&et(()=>{let m=!1;const x=new s(_.origin,{body:new Qe,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!x}),l=i&&d&&et(()=>u.isReadableStream(new r("").body)),c={stream:l&&(m=>m.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!c[m]&&(c[m]=(x,g)=>{let S=x&&x[m];if(S)return S.call(x);throw new N(`Response type '${m}' is not supported`,N.ERR_NOT_SUPPORT,g)})});const f=async m=>{if(m==null)return 0;if(u.isBlob(m))return m.size;if(u.isSpecCompliantForm(m))return(await new s(_.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(u.isArrayBufferView(m)||u.isArrayBuffer(m))return m.byteLength;if(u.isURLSearchParams(m)&&(m=m+""),u.isString(m))return(await p(m)).byteLength},y=async(m,x)=>{const g=u.toFiniteNumber(m.getContentLength());return g??f(x)};return async m=>{let{url:x,method:g,data:S,signal:w,cancelToken:C,timeout:T,onDownloadProgress:R,onUploadProgress:M,responseType:L,headers:W,withCredentials:v="same-origin",fetchOptions:j}=Et(m),A=e||fetch;L=L?(L+"").toLowerCase():"text";let O=lr([w,C&&C.toAbortSignal()],T),P=null;const E=O&&O.unsubscribe&&(()=>{O.unsubscribe()});let $;try{if(M&&h&&g!=="get"&&g!=="head"&&($=await y(W,S))!==0){let X=new s(x,{method:"POST",body:S,duplex:"half"}),Z;if(u.isFormData(S)&&(Z=X.headers.get("content-type"))&&W.setContentType(Z),X.body){const[Se,ue]=Je($,xe(Ke(M)));S=Ge(X.body,Ye,Se,ue)}}u.isString(v)||(v=v?"include":"omit");const D=o&&"credentials"in s.prototype,re={...j,signal:O,method:g.toUpperCase(),headers:W.normalize().toJSON(),body:S,duplex:"half",credentials:D?v:void 0};P=o&&new s(x,re);let z=await(o?A(P,j):A(x,re));const ne=l&&(L==="stream"||L==="response");if(l&&(R||ne&&E)){const X={};["status","statusText","headers"].forEach(Ue=>{X[Ue]=z[Ue]});const Z=u.toFiniteNumber(z.headers.get("content-length")),[Se,ue]=R&&Je(Z,xe(Ke(R),!0))||[];z=new r(Ge(z.body,Ye,Se,()=>{ue&&ue(),E&&E()}),X)}L=L||"text";let de=await c[u.findKey(c,L)||"text"](z,m);return!ne&&E&&E(),await new Promise((X,Z)=>{Nt(X,Z,{data:de,headers:U.from(z.headers),status:z.status,statusText:z.statusText,config:m,request:P})})}catch(D){throw E&&E(),D&&D.name==="TypeError"&&/Load failed|fetch/i.test(D.message)?Object.assign(new N("Network Error",N.ERR_NETWORK,m,P),{cause:D.cause||D}):N.from(D,D&&D.code,m,P)}}},fr=new Map,Ct=t=>{let e=t?t.env:{};const{fetch:s,Request:r,Response:a}=e,o=[r,a,s];let i=o.length,d=i,p,h,l=fr;for(;d--;)p=o[d],h=l.get(p),h===void 0&&l.set(p,h=d?new Map:mr(e)),l=h;return h};Ct();const De={http:Ls,xhr:or,fetch:{get:Ct}};u.forEach(De,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const tt=t=>`- ${t}`,pr=t=>u.isFunction(t)||t===null||t===!1,At={getAdapter:(t,e)=>{t=u.isArray(t)?t:[t];const{length:s}=t;let r,a;const o={};for(let i=0;i<s;i++){r=t[i];let d;if(a=r,!pr(r)&&(a=De[(d=String(r)).toLowerCase()],a===void 0))throw new N(`Unknown adapter '${d}'`);if(a&&(u.isFunction(a)||(a=a.get(e))))break;o[d||"#"+i]=a}if(!a){const i=Object.entries(o).map(([p,h])=>`adapter ${p} `+(h===!1?"is not supported by the environment":"is not available in the build"));let d=s?i.length>1?`since :
`+i.map(tt).join(`
`):" "+tt(i[0]):"as no adapter specified";throw new N("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return a},adapters:De};function Ae(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new se(null,t)}function st(t){return Ae(t),t.headers=U.from(t.headers),t.data=Ce.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),At.getAdapter(t.adapter||ce.adapter,t)(t).then(function(r){return Ae(t),r.data=Ce.call(t,t.transformResponse,r),r.headers=U.from(r.headers),r},function(r){return vt(r)||(Ae(t),r&&r.response&&(r.response.data=Ce.call(t,t.transformResponse,r.response),r.response.headers=U.from(r.response.headers))),Promise.reject(r)})}const Tt="1.12.2",Ne={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Ne[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const rt={};Ne.transitional=function(e,s,r){function a(o,i){return"[Axios v"+Tt+"] Transitional option '"+o+"'"+i+(r?". "+r:"")}return(o,i,d)=>{if(e===!1)throw new N(a(i," has been removed"+(s?" in "+s:"")),N.ERR_DEPRECATED);return s&&!rt[i]&&(rt[i]=!0,console.warn(a(i," has been deprecated since v"+s+" and will be removed in the near future"))),e?e(o,i,d):!0}};Ne.spelling=function(e){return(s,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function gr(t,e,s){if(typeof t!="object")throw new N("options must be an object",N.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let a=r.length;for(;a-- >0;){const o=r[a],i=e[o];if(i){const d=t[o],p=d===void 0||i(d,o,t);if(p!==!0)throw new N("option "+o+" must be "+p,N.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new N("Unknown option "+o,N.ERR_BAD_OPTION)}}const ge={assertOptions:gr,validators:Ne},K=ge.validators;let Y=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Ve,response:new Ve}}async request(e,s){try{return await this._request(e,s)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(e,s){typeof e=="string"?(s=s||{},s.url=e):s=e||{},s=Q(this.defaults,s);const{transitional:r,paramsSerializer:a,headers:o}=s;r!==void 0&&ge.assertOptions(r,{silentJSONParsing:K.transitional(K.boolean),forcedJSONParsing:K.transitional(K.boolean),clarifyTimeoutError:K.transitional(K.boolean)},!1),a!=null&&(u.isFunction(a)?s.paramsSerializer={serialize:a}:ge.assertOptions(a,{encode:K.function,serialize:K.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),ge.assertOptions(s,{baseUrl:K.spelling("baseURL"),withXsrfToken:K.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let i=o&&u.merge(o.common,o[s.method]);o&&u.forEach(["delete","get","head","post","put","patch","common"],m=>{delete o[m]}),s.headers=U.concat(i,o);const d=[];let p=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(s)===!1||(p=p&&x.synchronous,d.unshift(x.fulfilled,x.rejected))});const h=[];this.interceptors.response.forEach(function(x){h.push(x.fulfilled,x.rejected)});let l,c=0,f;if(!p){const m=[st.bind(this),void 0];for(m.unshift(...d),m.push(...h),f=m.length,l=Promise.resolve(s);c<f;)l=l.then(m[c++],m[c++]);return l}f=d.length;let y=s;for(;c<f;){const m=d[c++],x=d[c++];try{y=m(y)}catch(g){x.call(this,g);break}}try{l=st.call(this,y)}catch(m){return Promise.reject(m)}for(c=0,f=h.length;c<f;)l=l.then(h[c++],h[c++]);return l}getUri(e){e=Q(this.defaults,e);const s=St(e.baseURL,e.url,e.allowAbsoluteUrls);return yt(s,e.params,e.paramsSerializer)}};u.forEach(["delete","get","head","options"],function(e){Y.prototype[e]=function(s,r){return this.request(Q(r||{},{method:e,url:s,data:(r||{}).data}))}});u.forEach(["post","put","patch"],function(e){function s(r){return function(o,i,d){return this.request(Q(d||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}Y.prototype[e]=s(),Y.prototype[e+"Form"]=s(!0)});let xr=class Rt{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(o){s=o});const r=this;this.promise.then(a=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](a);r._listeners=null}),this.promise.then=a=>{let o;const i=new Promise(d=>{r.subscribe(d),o=d}).then(a);return i.cancel=function(){r.unsubscribe(o)},i},e(function(o,i,d){r.reason||(r.reason=new se(o,i,d),s(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const s=this._listeners.indexOf(e);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const e=new AbortController,s=r=>{e.abort(r)};return this.subscribe(s),e.signal.unsubscribe=()=>this.unsubscribe(s),e.signal}static source(){let e;return{token:new Rt(function(a){e=a}),cancel:e}}};function br(t){return function(s){return t.apply(null,s)}}function yr(t){return u.isObject(t)&&t.isAxiosError===!0}const Ie={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ie).forEach(([t,e])=>{Ie[e]=t});function kt(t){const e=new Y(t),s=ot(Y.prototype.request,e);return u.extend(s,Y.prototype,e,{allOwnKeys:!0}),u.extend(s,e,null,{allOwnKeys:!0}),s.create=function(a){return kt(Q(t,a))},s}const k=kt(ce);k.Axios=Y;k.CanceledError=se;k.CancelToken=xr;k.isCancel=vt;k.VERSION=Tt;k.toFormData=ve;k.AxiosError=N;k.Cancel=k.CanceledError;k.all=function(e){return Promise.all(e)};k.spread=br;k.isAxiosError=yr;k.mergeConfig=Q;k.AxiosHeaders=U;k.formToJSON=t=>jt(u.isHTMLForm(t)?new FormData(t):t);k.getAdapter=At.getAdapter;k.HttpStatusCode=Ie;k.default=k;const{Axios:$r,AxiosError:Hr,CanceledError:qr,isCancel:Vr,CancelToken:Wr,VERSION:Jr,all:Kr,Cancel:Xr,isAxiosError:Gr,spread:Yr,toFormData:Qr,AxiosHeaders:Zr,HttpStatusCode:en,formToJSON:tn,getAdapter:sn,mergeConfig:rn}=k,Te={},Lt=window.location.hostname.includes("github.io"),wr=window.location.hostname==="localhost"&&!Lt;class jr{constructor(){J(this,"axiosInstance",null);J(this,"useClientStorage");this.useClientStorage=Lt||!wr,this.useClientStorage||(this.axiosInstance=k.create({baseURL:(Te==null?void 0:Te.VITE_API_URL)||"http://localhost:3001",timeout:1e4,headers:{"Content-Type":"application/json"}}),this.setupInterceptors())}setupInterceptors(){this.axiosInstance&&(this.axiosInstance.interceptors.request.use(e=>{const s=sessionStorage.getItem("aves-session-id");return s&&(e.headers["X-Session-Id"]=s),e},e=>Promise.reject(e)),this.axiosInstance.interceptors.response.use(e=>e,e=>{var s;return((s=e.response)==null?void 0:s.status)===503&&(console.warn("Backend unavailable, switching to client storage"),this.useClientStorage=!0),Promise.reject(e)}))}async getAnnotations(e){if(this.useClientStorage)return I.getAnnotations(e);try{return(await this.axiosInstance.get("/api/annotations",{params:{imageId:e}})).data}catch(s){return console.error("API error, falling back to client storage:",s),I.getAnnotations(e)}}async createAnnotation(e){if(this.useClientStorage)throw new Error("Cannot create annotations in static mode");return(await this.axiosInstance.post("/api/annotations",e)).data}async getSpecies(e){if(this.useClientStorage)return I.getSpecies(e);try{return(await this.axiosInstance.get("/api/species",{params:e})).data}catch(s){return console.error("API error, falling back to client storage:",s),I.getSpecies(e)}}async getSpeciesById(e){return(await this.getSpecies()).find(r=>r.id===e)||null}async getExercises(e){if(this.useClientStorage)return I.getExercises(e);try{return(await this.axiosInstance.get("/api/exercises",{params:{type:e}})).data}catch(s){return console.error("API error, falling back to client storage:",s),I.getExercises(e)}}async submitExerciseAnswer(e,s){if(this.useClientStorage){const a={exerciseId:e,answer:s,correct:this.validateAnswer(e,s),timestamp:new Date};return await I.saveExerciseResult(a),a}return(await this.axiosInstance.post("/api/exercises/submit",{exerciseId:e,answer:s})).data}validateAnswer(e,s){return Math.random()>.3}async saveInteraction(e){if(this.useClientStorage)return I.saveInteraction(e);await this.axiosInstance.post("/api/vocabulary/interact",e)}async getInteractions(e){if(this.useClientStorage)return I.getInteractions(e);try{return(await this.axiosInstance.get("/api/vocabulary/interactions",{params:{sessionId:e}})).data}catch(s){return console.error("API error, falling back to client storage:",s),I.getInteractions(e)}}async saveProgress(e){if(this.useClientStorage)return I.saveProgress(e);await this.axiosInstance.post("/api/progress",e)}async getProgress(e){if(this.useClientStorage)return I.getProgress(e);try{return(await this.axiosInstance.get("/api/progress",{params:{sessionId:e}})).data}catch(s){return console.error("API error, falling back to client storage:",s),I.getProgress(e)}}async exportUserData(){return I.exportData()}async importUserData(e){return I.importData(e)}async clearAllData(){return I.clearAllData()}isUsingClientStorage(){return this.useClientStorage}getStorageMode(){return this.useClientStorage?"client":"backend"}}const B=new jr,H={annotations:{list:t=>B.getAnnotations(t),create:t=>B.createAnnotation(t)},species:{list:t=>B.getSpecies(t),get:t=>B.getSpeciesById(t)},exercises:{list:t=>B.getExercises(t),submit:(t,e)=>B.submitExerciseAnswer(t,e)},vocabulary:{saveInteraction:t=>B.saveInteraction(t),getInteractions:t=>B.getInteractions(t)},progress:{save:t=>B.saveProgress(t),get:t=>B.getProgress(t)},utils:{export:()=>B.exportUserData(),import:t=>B.importUserData(t),clear:()=>B.clearAllData(),getMode:()=>B.getStorageMode()}},Fe=()=>{const[t,e]=b.useState(null),[s,r]=b.useState(!1),a=b.useCallback(()=>{let c=sessionStorage.getItem("aves-session-id");return c||(c=`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,sessionStorage.setItem("aves-session-id",c)),c},[]),o=b.useCallback(async()=>{r(!0);const c=a();try{const f=await H.progress.get(c);if(f)e({...f,lastActivity:new Date(f.lastActivity),startedAt:new Date(f.startedAt)});else{const y={sessionId:c,termsDiscovered:[],exercisesCompleted:0,correctAnswers:0,totalAnswers:0,currentStreak:0,longestStreak:0,lastActivity:new Date,startedAt:new Date,vocabularyMastery:{}};e(y),await H.progress.save(y)}}catch(f){console.error("Error initializing progress:",f),e({sessionId:c,termsDiscovered:[],exercisesCompleted:0,correctAnswers:0,totalAnswers:0,currentStreak:0,longestStreak:0,lastActivity:new Date,startedAt:new Date,vocabularyMastery:{}})}finally{r(!1)}},[a]),i=b.useCallback(async c=>{if(t&&!t.termsDiscovered.includes(c)){const f={...t,termsDiscovered:[...t.termsDiscovered,c],lastActivity:new Date};e(f),await H.progress.save(f)}},[t]),d=b.useCallback(async c=>{if(!t)return;const f={...t,exercisesCompleted:t.exercisesCompleted+1,correctAnswers:c?t.correctAnswers+1:t.correctAnswers,totalAnswers:t.totalAnswers+1,currentStreak:c?t.currentStreak+1:0,longestStreak:c&&t.currentStreak+1>t.longestStreak?t.currentStreak+1:t.longestStreak,lastActivity:new Date};e(f),await H.progress.save(f)},[t]),p=b.useCallback(async(c,f)=>{if(!t)return;const y=t.vocabularyMastery[c]||0,x=Math.max(0,Math.min(100,y+(f?10:-5))),g={...t,vocabularyMastery:{...t.vocabularyMastery,[c]:x},lastActivity:new Date};e(g),await H.progress.save(g)},[t]),h=b.useCallback(()=>{if(!t)return{termsLearned:0,exercisesCompleted:0,accuracy:0,currentStreak:0,longestStreak:0,sessionDuration:0,masteredTerms:0};const c=t.totalAnswers>0?Math.round(t.correctAnswers/t.totalAnswers*100):0,f=Math.round((new Date().getTime()-new Date(t.startedAt).getTime())/1e3/60),y=Object.values(t.vocabularyMastery).filter(m=>m>=80).length;return{termsLearned:t.termsDiscovered.length,exercisesCompleted:t.exercisesCompleted,accuracy:c,currentStreak:t.currentStreak,longestStreak:t.longestStreak,sessionDuration:f,masteredTerms:y}},[t]),l=b.useCallback(async()=>{const f={sessionId:a(),termsDiscovered:[],exercisesCompleted:0,correctAnswers:0,totalAnswers:0,currentStreak:0,longestStreak:0,lastActivity:new Date,startedAt:new Date,vocabularyMastery:{}};e(f),await H.progress.save(f)},[a]);return b.useEffect(()=>{o()},[]),{progress:t,loading:s,recordTermDiscovery:i,recordExerciseCompletion:d,updateVocabularyMastery:p,getStats:h,resetProgress:l,sessionId:(t==null?void 0:t.sessionId)||a()}},vr=()=>{const{getStats:t,loading:e}=Fe(),s=t();return n.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-green-50 to-yellow-50",children:[n.jsxs("div",{className:"relative overflow-hidden",children:[n.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-gray-900 mb-6",children:n.jsx("span",{className:"block text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-blue-600",children:"Birds in Spanish"})}),n.jsx("p",{className:"text-xl text-gray-600 mb-8 max-w-2xl mx-auto",children:"Beautiful photos of birds. Real Spanish vocabulary. Natural learning."}),n.jsxs("div",{className:"flex gap-4 justify-center",children:[n.jsx(q,{to:"/learn",className:"px-8 py-4 bg-gradient-to-r from-green-600 to-blue-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:"Start Learning"}),n.jsx(q,{to:"/practice",className:"px-8 py-4 bg-white text-gray-800 font-semibold rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:"Practice Exercises"})]})]})}),n.jsx("div",{className:"absolute top-20 left-10 text-4xl animate-bounce",children:"🦜"}),n.jsx("div",{className:"absolute top-40 right-20 text-3xl animate-pulse",children:"🦅"}),n.jsx("div",{className:"absolute bottom-20 left-1/4 text-4xl animate-bounce delay-150",children:"🦩"})]}),n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[n.jsx("h2",{className:"text-3xl font-bold text-center mb-8 text-gray-800",children:"Your Learning Progress"}),e?n.jsx("div",{className:"text-center text-gray-500",children:"Loading progress..."}):n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform hover:scale-105 transition-transform",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("div",{className:"text-3xl",children:"📚"}),n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.termsLearned})]}),n.jsx("h3",{className:"text-gray-600 font-medium",children:"Terms Discovered"}),n.jsx("div",{className:"mt-2 text-sm text-gray-500",children:"Spanish vocabulary learned"})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform hover:scale-105 transition-transform",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("div",{className:"text-3xl",children:"✏️"}),n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.exercisesCompleted})]}),n.jsx("h3",{className:"text-gray-600 font-medium",children:"Exercises Done"}),n.jsx("div",{className:"mt-2 text-sm text-gray-500",children:"Practice sessions completed"})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform hover:scale-105 transition-transform",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("div",{className:"text-3xl",children:"🎯"}),n.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[s.accuracy,"%"]})]}),n.jsx("h3",{className:"text-gray-600 font-medium",children:"Accuracy"}),n.jsx("div",{className:"mt-2 text-sm text-gray-500",children:"Exercise success rate"})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 transform hover:scale-105 transition-transform",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("div",{className:"text-3xl",children:"🔥"}),n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.currentStreak})]}),n.jsx("h3",{className:"text-gray-600 font-medium",children:"Current Streak"}),n.jsx("div",{className:"mt-2 text-sm text-gray-500",children:"Correct answers in a row"})]})]}),n.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsx("div",{className:"bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Session Time"}),n.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:[s.sessionDuration," min"]})]}),n.jsx("div",{className:"text-4xl",children:"⏱️"})]})}),n.jsx("div",{className:"bg-gradient-to-r from-green-100 to-blue-100 rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Mastered Terms"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:s.masteredTerms})]}),n.jsx("div",{className:"text-4xl",children:"⭐"})]})}),n.jsx("div",{className:"bg-gradient-to-r from-yellow-100 to-orange-100 rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Best Streak"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:s.longestStreak})]}),n.jsx("div",{className:"text-4xl",children:"🏆"})]})})]})]}),n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[n.jsx("h2",{className:"text-3xl font-bold text-center mb-12 text-gray-800",children:"How It Works"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"bg-gradient-to-br from-green-400 to-blue-500 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 text-white text-3xl",children:"1"}),n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Explore Images"}),n.jsx("p",{className:"text-gray-600",children:"Click on bird photographs to discover Spanish vocabulary through interactive annotations"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"bg-gradient-to-br from-blue-400 to-purple-500 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 text-white text-3xl",children:"2"}),n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Learn Progressively"}),n.jsx("p",{className:"text-gray-600",children:"Vocabulary reveals gradually from basic terms to etymology and contextual examples"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"bg-gradient-to-br from-purple-400 to-pink-500 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 text-white text-3xl",children:"3"}),n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Practice & Master"}),n.jsx("p",{className:"text-gray-600",children:"Reinforce learning with interactive exercises and track your progress over time"})]})]})]}),n.jsx("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 py-16",children:n.jsxs("div",{className:"max-w-4xl mx-auto text-center px-4",children:[n.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Ready to Start Learning?"}),n.jsx("p",{className:"text-xl text-green-100 mb-8",children:"Join thousands discovering Spanish through the beauty of birds"}),n.jsx(q,{to:"/learn",className:"inline-block px-8 py-4 bg-white text-green-600 font-bold rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:"Begin Your Journey"})]})})]})},Ot=()=>{const[t,e]=b.useState({isMobile:!1,isTablet:!1,isDesktop:!0,hasTouch:!1,screenSize:"lg",orientation:"landscape"});return b.useEffect(()=>{const s=()=>{const r=window.innerWidth,a=window.innerHeight,o="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;let i;r<640?i="xs":r<768?i="sm":r<1024?i="md":r<1280?i="lg":i="xl";const d=r<768&&o,p=r>=768&&r<1024&&o,h=r>=1024||!o,l=r>a?"landscape":"portrait";e({isMobile:d,isTablet:p,isDesktop:h,hasTouch:o,screenSize:i,orientation:l})};return s(),window.addEventListener("resize",s),window.addEventListener("orientationchange",s),()=>{window.removeEventListener("resize",s),window.removeEventListener("orientationchange",s)}},[]),t},Nr=({imageUrl:t,annotations:e,onAnnotationDiscover:s,showLabels:r=!1})=>{const a=b.useRef(null),o=b.useRef(null),[i,d]=b.useState(null),[p,h]=b.useState(null),[l,c]=b.useState(null),[f,y]=b.useState(1),[m,x]=b.useState({width:800,height:600}),{isMobile:g,hasTouch:S,screenSize:w}=Ot(),{recordTermDiscovery:C}=Fe();b.useEffect(()=>{const v=new Image;return v.crossOrigin="anonymous",v.onload=()=>{d(v),T()},v.onerror=()=>{console.error("Failed to load image:",t)},v.src=t,()=>{v.onload=null,v.onerror=null}},[t]);const T=b.useCallback(()=>{if(!o.current||!i)return;const j=o.current.clientWidth,A=window.innerHeight*(g?.5:.7),O=j/i.width,P=A/i.height,E=Math.min(O,P,1),$=Math.floor(i.width*E),D=Math.floor(i.height*E);y(E),x({width:$,height:D})},[i,g]);b.useEffect(()=>{const v=()=>{T()};return window.addEventListener("resize",v),v(),()=>window.removeEventListener("resize",v)},[T]),b.useEffect(()=>{const v=a.current;if(!v||!i)return;const j=v.getContext("2d");j&&(j.clearRect(0,0,v.width,v.height),j.drawImage(i,0,0,v.width,v.height),e.forEach(A=>{if(!A.isVisible)return;const{boundingBox:O}=A,P=O.topLeft.x*f,E=O.topLeft.y*f,$=O.width*f,D=O.height*f,re=(p==null?void 0:p.id)===A.id,z=(l==null?void 0:l.id)===A.id;if(z?(j.strokeStyle="#10b981",j.lineWidth=g?3:2,j.fillStyle="rgba(16, 185, 129, 0.2)"):re&&!S?(j.strokeStyle="#3b82f6",j.lineWidth=2,j.fillStyle="rgba(59, 130, 246, 0.1)"):(j.strokeStyle="#6b7280",j.lineWidth=1,j.fillStyle="rgba(107, 114, 128, 0.05)"),j.fillRect(P,E,$,D),j.strokeRect(P,E,$,D),(r||z||g&&re)&&(j.fillStyle=z?"#10b981":"#3b82f6",j.fillRect(P,E-24,$,24),j.fillStyle="white",j.font=`${g?"14px":"12px"} sans-serif`,j.textAlign="center",j.textBaseline="middle",j.fillText(A.spanishTerm||"",P+$/2,E-12)),g&&!z){const ne=P+$/2,de=E+D/2;j.beginPath(),j.arc(ne,de,8,0,Math.PI*2),j.fillStyle="rgba(59, 130, 246, 0.5)",j.fill(),j.beginPath(),j.arc(ne,de,4,0,Math.PI*2),j.fillStyle="#3b82f6",j.fill()}}))},[i,e,p,l,f,g,S,r]);const R=b.useCallback(v=>{const j=g?20:0;for(const A of e){if(!A.isVisible)continue;const{boundingBox:O}=A,P=O.topLeft.x*f,E=O.topLeft.y*f,$=O.width*f,D=O.height*f;if(v.x>=P-j&&v.x<=P+$+j&&v.y>=E-j&&v.y<=E+D+j)return A}return null},[e,f,g]),M=b.useCallback(v=>{if(S)return;const j=a.current;if(!j)return;const A=j.getBoundingClientRect(),O="touches"in v?v.touches[0].clientX-A.left:v.clientX-A.left,P="touches"in v?v.touches[0].clientY-A.top:v.clientY-A.top,E=R({x:O,y:P});h(E),j.style.cursor=E?"pointer":"default"},[R,S]),L=b.useCallback(v=>{const j=a.current;if(!j)return;const A=j.getBoundingClientRect(),O="touches"in v?v.touches[0].clientX-A.left:v.clientX-A.left,P="touches"in v?v.touches[0].clientY-A.top:v.clientY-A.top,E=R({x:O,y:P});E?(c(E),s==null||s(E),C(E.spanishTerm||""),S&&"vibrate"in navigator&&navigator.vibrate(50),g&&setTimeout(()=>{c(null)},3e3)):c(null)},[R,s,C,S,g]),W=b.useCallback(()=>{h(null),a.current&&(a.current.style.cursor="default")},[]);return n.jsxs("div",{ref:o,className:"relative w-full",children:[n.jsx("canvas",{ref:a,width:m.width,height:m.height,className:"w-full h-auto rounded-lg shadow-lg",onMouseMove:M,onMouseDown:L,onMouseLeave:W,onTouchStart:L,onTouchMove:M,style:{maxWidth:"100%",touchAction:"manipulation"}}),g&&e.length>0&&!l&&n.jsx("div",{className:"absolute top-2 left-2 right-2 bg-black bg-opacity-50 text-white text-sm p-2 rounded-lg",children:"Tap on highlighted areas to learn Spanish vocabulary"}),g&&l&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-white shadow-lg p-4 rounded-t-lg",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-900",children:l.spanishTerm}),n.jsx("p",{className:"text-sm text-gray-500 italic",children:l.pronunciation}),n.jsx("p",{className:"text-base text-gray-700 mt-1",children:l.englishTerm})]}),n.jsx("button",{onClick:()=>c(null),className:"text-gray-400 hover:text-gray-600",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]})},nt=({audioUrl:t,text:e,type:s,size:r="medium",onPlay:a,autoPlay:o=!1})=>{const[i,d]=b.useState(!1),[p,h]=b.useState(!1),[l,c]=b.useState(null),f=b.useRef(null),y=b.useRef(null),m={small:"w-8 h-8 text-xs",medium:"w-10 h-10 text-sm",large:"w-12 h-12 text-base"};b.useEffect(()=>{if(t){const w=new Audio(t);w.preload="metadata",w.addEventListener("loadstart",()=>h(!0)),w.addEventListener("canplay",()=>h(!1)),w.addEventListener("error",()=>{c("Failed to load audio"),h(!1)}),w.addEventListener("ended",()=>d(!1)),f.current=w}else if(e&&s==="pronunciation")if("speechSynthesis"in window){const w=new SpeechSynthesisUtterance(e);w.lang="es-ES",w.rate=.9,w.pitch=1,w.volume=1;const T=speechSynthesis.getVoices().find(R=>R.lang.startsWith("es")&&R.lang.includes("ES"));T&&(w.voice=T),w.addEventListener("end",()=>d(!1)),w.addEventListener("error",()=>{c("Speech synthesis failed"),d(!1)}),y.current=w}else c("Speech synthesis not supported");return()=>{f.current&&(f.current.pause(),f.current=null),y.current&&(speechSynthesis.cancel(),y.current=null)}},[t,e,s]),b.useEffect(()=>{o&&!l&&x()},[o]);const x=async()=>{c(null);try{if(i)f.current&&(f.current.pause(),f.current.currentTime=0),y.current&&speechSynthesis.cancel(),d(!1);else if(d(!0),a==null||a(),f.current)await f.current.play();else if(y.current)speechSynthesis.speak(y.current);else throw new Error("No audio source available")}catch(w){console.error("Playback error:",w),c("Failed to play audio"),d(!1)}},g=()=>p?n.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):l?n.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):i?n.jsxs("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:[n.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),n.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}):s==="pronunciation"?n.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"})}):n.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),S=()=>{const w=`${m[r]} rounded-full flex items-center justify-center transition-all duration-200 `;return l?w+"bg-red-100 text-red-600 hover:bg-red-200 cursor-not-allowed":i?w+"bg-blue-500 text-white shadow-lg scale-110":s==="pronunciation"?w+"bg-green-100 text-green-600 hover:bg-green-200 hover:scale-105":w+"bg-purple-100 text-purple-600 hover:bg-purple-200 hover:scale-105"};return n.jsxs("div",{className:"inline-flex items-center gap-2",children:[n.jsx("button",{onClick:x,disabled:p||!!l,className:S(),"aria-label":i?"Stop audio":s==="pronunciation"?"Play pronunciation":"Play bird call",title:l||(i?"Stop":"Play"),children:g()}),e&&s==="pronunciation"&&n.jsx("span",{className:"text-sm text-gray-600 italic",children:e}),l&&n.jsx("span",{className:"text-xs text-red-500",children:l})]})},Sr=t=>{const[e,s]=b.useState([]),[r,a]=b.useState(!1),[o,i]=b.useState(null),d=b.useCallback(async c=>{a(!0),i(null);try{const f=await H.annotations.list(c||t);return s(f),f}catch(f){return i("Failed to load annotations"),console.error("Error fetching annotations:",f),s([]),[]}finally{a(!1)}},[t]),p=b.useCallback(c=>e.filter(f=>{var y,m;return((y=f.spanishTerm)==null?void 0:y.toLowerCase().includes(c.toLowerCase()))||((m=f.englishTerm)==null?void 0:m.toLowerCase().includes(c.toLowerCase()))}),[e]),h=b.useCallback(c=>e.filter(f=>f.difficultyLevel===c),[e]),l=b.useCallback(()=>{const c=new Map;return e.forEach(f=>{f.spanishTerm&&!c.has(f.spanishTerm)&&c.set(f.spanishTerm,f)}),Array.from(c.values())},[e]);return b.useEffect(()=>{H.utils.getMode()==="client"&&e.length===0&&d()},[]),{annotations:e,loading:r,error:o,fetchAnnotations:d,getAnnotationsByTerm:p,getAnnotationsByDifficulty:h,getUniqueTerms:l}},Er=()=>{const[t,e]=b.useState(null),[s,r]=b.useState(new Set),[a,o]=b.useState(!1),{annotations:i,loading:d}=Sr(),{progress:p,recordTermDiscovery:h,getStats:l}=Fe(),{isMobile:c}=Ot();l(),b.useEffect(()=>{p!=null&&p.termsDiscovered&&r(new Set(p.termsDiscovered))},[p]),b.useEffect(()=>{s.size>0&&s.size%5===0&&(o(!0),setTimeout(()=>o(!1),5e3))},[s.size]);const f=y=>{if(e(y),y.spanishTerm&&!s.has(y.spanishTerm)){const m=new Set(s);m.add(y.spanishTerm),r(m),h(y.spanishTerm)}};return d?n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsx("div",{className:"text-gray-500",children:"Loading learning materials..."})}):n.jsx("div",{className:`min-h-screen bg-gradient-to-br from-green-50 to-blue-50 ${c?"pb-20":""}`,children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Interactive Learning"}),n.jsxs("p",{className:"text-gray-600",children:[c?"Tap":"Click"," on highlighted areas to discover vocabulary"]})]}),n.jsxs("div",{className:"flex gap-3 mt-4 md:mt-0",children:[n.jsxs("div",{className:"bg-white rounded-lg px-4 py-2 shadow-sm",children:[n.jsx("span",{className:"text-sm text-gray-500",children:"Discovered"}),n.jsx("span",{className:"ml-2 font-bold text-green-600",children:s.size})]}),n.jsxs("div",{className:"bg-white rounded-lg px-4 py-2 shadow-sm",children:[n.jsx("span",{className:"text-sm text-gray-500",children:"Total"}),n.jsx("span",{className:"ml-2 font-bold text-blue-600",children:i.length})]})]})]})}),n.jsxs("div",{className:`grid ${c?"grid-cols-1":"grid-cols-1 lg:grid-cols-3"} gap-6`,children:[n.jsx("div",{className:`${c?"":"lg:col-span-2"}`,children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4",children:[n.jsx(Nr,{imageUrl:"https://images.unsplash.com/photo-1444464666168-49d633b86797?w=1200",annotations:i,onAnnotationDiscover:f,showLabels:!1}),n.jsxs("div",{className:"mt-4",children:[n.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[n.jsx("span",{children:"Discovery Progress"}),n.jsxs("span",{children:[Math.round(s.size/i.length*100),"%"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:"bg-gradient-to-r from-green-400 to-blue-500 h-2 rounded-full transition-all duration-500",style:{width:`${s.size/i.length*100}%`}})})]})]})}),n.jsxs("div",{className:`${c?"":"lg:col-span-1"}`,children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Vocabulary Details"}),t?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:t.spanishTerm}),n.jsx(nt,{text:t.spanishTerm,type:"pronunciation",size:"medium"})]}),n.jsx("p",{className:"text-sm text-gray-500 italic mt-1",children:t.pronunciation})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"English:"}),n.jsx("p",{className:"text-lg font-medium",children:t.englishTerm})]}),t.etymology&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Etymology:"}),n.jsx("p",{className:"text-sm text-gray-700",children:t.etymology})]}),t.exampleSentence&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Example:"}),n.jsxs("p",{className:"text-sm text-gray-700 italic",children:['"',t.exampleSentence,'"']})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Difficulty:"}),n.jsx("div",{className:"flex gap-1",children:[1,2,3].map(y=>n.jsx("div",{className:`w-2 h-2 rounded-full ${y<=(t.difficultyLevel||1)?"bg-yellow-400":"bg-gray-300"}`},y))})]})]}):n.jsx("p",{className:"text-gray-500",children:"Select an annotation to see details"})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["Discovered Terms (",s.size,")"]}),n.jsx("div",{className:"max-h-48 overflow-y-auto",children:s.size>0?n.jsx("div",{className:"space-y-2",children:Array.from(s).map(y=>n.jsxs("div",{className:"flex items-center justify-between py-1 px-2 hover:bg-gray-50 rounded",children:[n.jsx("span",{className:"text-sm text-gray-700",children:y}),n.jsx(nt,{text:y,type:"pronunciation",size:"small"})]},y))}):n.jsx("p",{className:"text-sm text-gray-500",children:"Start exploring to discover terms"})})]})]})]}),a&&n.jsxs("div",{className:"fixed bottom-4 right-4 bg-green-500 text-white rounded-lg shadow-xl p-4 max-w-sm animate-pulse",children:[n.jsx("p",{className:"font-semibold mb-2",children:"Great progress! 🎉"}),n.jsxs("p",{className:"text-sm mb-3",children:["You've discovered ",s.size," terms. Ready to practice?"]}),n.jsx(q,{to:"/practice",className:"inline-block bg-white text-green-600 px-4 py-2 rounded font-semibold hover:bg-green-50 transition-colors",children:"Practice Now"})]}),c&&n.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg",children:n.jsxs("div",{className:"flex justify-around py-2",children:[n.jsxs(q,{to:"/",className:"flex flex-col items-center p-2 text-gray-600",children:[n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),n.jsx("span",{className:"text-xs mt-1",children:"Home"})]}),n.jsxs("div",{className:"flex flex-col items-center p-2 text-blue-600",children:[n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),n.jsx("span",{className:"text-xs mt-1",children:"Learn"})]}),n.jsxs(q,{to:"/practice",className:"flex flex-col items-center p-2 text-gray-600",children:[n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),n.jsx("span",{className:"text-xs mt-1",children:"Practice"})]}),n.jsxs(q,{to:"/species",className:"flex flex-col items-center p-2 text-gray-600",children:[n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),n.jsx("span",{className:"text-xs mt-1",children:"Species"})]})]})})]})})},Cr=({exercise:t,onAnswer:e,disabled:s=!1})=>{const[r,a]=b.useState(null),[o,i]=b.useState(!1),d=h=>{s||o||(a(h),i(!0),e(h))},p=h=>o?h===t.correctOptionId?"ring-2 ring-green-500 bg-green-50":r===h&&h!==t.correctOptionId?"ring-2 ring-red-500 bg-red-50":"opacity-50":r===h?"ring-2 ring-blue-500":"hover:ring-2 hover:ring-gray-300";return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:t.instructions}),n.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.targetTerm})]}),n.jsx("div",{className:"grid grid-cols-2 gap-4",children:t.options.map((h,l)=>n.jsxs("button",{onClick:()=>d(h.id),disabled:s||o,className:`
              relative p-4 rounded-lg border-2 transition-all
              ${p(h.id)}
              ${!o&&!s?"cursor-pointer":"cursor-default"}
            `,children:[n.jsx("div",{className:"aspect-square bg-gray-200 rounded-lg mb-2 flex items-center justify-center",children:n.jsx("span",{className:"text-4xl",children:"🦅"})}),n.jsx("div",{className:"absolute top-2 left-2 bg-white rounded-full px-2 py-1 text-sm font-semibold",children:String.fromCharCode(65+l)}),o&&h.id===t.correctOptionId&&n.jsx("div",{className:"absolute top-2 right-2 text-green-500",children:"✓"}),o&&r===h.id&&h.id!==t.correctOptionId&&n.jsx("div",{className:"absolute top-2 right-2 text-red-500",children:"✗"})]},h.id))})]})},Ar=({exercise:t,onAnswer:e,disabled:s=!1})=>{const[r,a]=b.useState(null),[o,i]=b.useState(!1),d=l=>{s||o||(a(l),i(!0),e(l))},p=l=>o?l===t.correctAnswer?"bg-green-500 text-white":r===l&&l!==t.correctAnswer?"bg-red-500 text-white":"bg-gray-100 text-gray-400 border border-gray-200":r===l?"bg-blue-500 text-white":"bg-white hover:bg-gray-50 text-gray-900 border border-gray-300",h=()=>{const l=t.sentence.split("___");return n.jsxs("p",{className:"text-xl leading-relaxed",children:[l[0],n.jsx("span",{className:"inline-block min-w-[100px] mx-2 pb-1 border-b-2 border-gray-400 text-center font-bold text-blue-600",children:o?n.jsx("span",{className:r===t.correctAnswer?"text-green-600":"text-red-600",children:r||"___"}):"___"}),l[1]]})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"text-center",children:n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:t.instructions})}),n.jsx("div",{className:"bg-gray-50 p-6 rounded-lg",children:h()}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.options.map((l,c)=>n.jsxs("button",{onClick:()=>d(l),disabled:s||o,className:`
              px-4 py-3 rounded-lg font-medium transition-all
              ${p(l)}
              ${!o&&!s?"cursor-pointer":"cursor-default"}
            `,children:[n.jsxs("span",{className:"mr-2",children:[String.fromCharCode(65+c),"."]}),l,o&&l===t.correctAnswer&&n.jsx("span",{className:"ml-2",children:"✓"}),o&&r===l&&l!==t.correctAnswer&&n.jsx("span",{className:"ml-2",children:"✗"})]},l))}),o&&n.jsx("div",{className:`p-4 rounded-lg ${r===t.correctAnswer?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r===t.correctAnswer?n.jsx("p",{className:"font-semibold",children:"¡Correcto!"}):n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"Incorrect."})," The answer was: ",n.jsx("strong",{children:t.correctAnswer})]})})]})},Tr=({exercise:t,onAnswer:e,disabled:s})=>{var m,x,g,S;const[r,a]=b.useState(null),[o,i]=b.useState(null),d={flamingo:[{id:"beak",label:"el pico",x:25,y:15,width:8,height:5},{id:"neck",label:"el cuello",x:22,y:20,width:6,height:15},{id:"legs",label:"las patas",x:20,y:50,width:10,height:30},{id:"feathers",label:"las plumas",x:15,y:35,width:20,height:15},{id:"wings",label:"las alas",x:10,y:30,width:15,height:20}],eagle:[{id:"beak",label:"el pico",x:45,y:20,width:8,height:6},{id:"talons",label:"las garras",x:40,y:65,width:12,height:10},{id:"eyes",label:"los ojos",x:43,y:18,width:5,height:3},{id:"wings",label:"las alas",x:25,y:30,width:30,height:25},{id:"tail",label:"la cola",x:35,y:55,width:15,height:12}],sparrow:[{id:"beak",label:"el pico",x:42,y:25,width:5,height:3},{id:"wings",label:"las alas",x:30,y:35,width:20,height:15},{id:"tail",label:"la cola",x:25,y:45,width:10,height:8},{id:"legs",label:"las patas",x:38,y:50,width:6,height:8},{id:"breast",label:"el pecho",x:35,y:38,width:10,height:10}]},p=((m=t.metadata)==null?void 0:m.bird)||"flamingo",h=((x=t.metadata)==null?void 0:x.targetPart)||"beak",l=d[p]||d.flamingo,c=w=>{s||(a(w),e(w))},f=w=>{const C=w.id===h,T=o===w.id,R=r===w.id;let M="transparent",L="transparent",W=0;return T&&!s&&(M="#3B82F6",L="rgba(59, 130, 246, 0.1)",W=.8),R&&s&&(C?(M="#10B981",L="rgba(16, 185, 129, 0.2)",W=1):(M="#EF4444",L="rgba(239, 68, 68, 0.2)",W=1)),{position:"absolute",left:`${w.x}%`,top:`${w.y}%`,width:`${w.width}%`,height:`${w.height}%`,border:`2px solid ${M}`,backgroundColor:L,opacity:W,borderRadius:"8px",cursor:s?"default":"pointer",transition:"all 0.2s ease-in-out",display:"flex",alignItems:"center",justifyContent:"center"}},y=()=>{const w={flamingo:"https://images.unsplash.com/photo-1535821265819-8e7ff3c30737?w=600",eagle:"https://images.unsplash.com/photo-1611689342806-0863700ce1e4?w=600",sparrow:"https://images.unsplash.com/photo-1552728089-57bdde30beb3?w=600",stork:"https://images.unsplash.com/photo-1596071915134-94f36f1d3188?w=600",owl:"https://images.unsplash.com/photo-1557401751-376608588678?w=600",peacock:"https://images.unsplash.com/photo-1512990641230-7e91cc31d0dc?w=600"};return w[p]||w.flamingo};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Visual Identification"}),n.jsxs("p",{className:"text-lg text-gray-700",children:["Click on: ",n.jsx("span",{className:"font-bold text-blue-600",children:t.prompt})]}),((g=t.metadata)==null?void 0:g.pronunciation)&&n.jsx("p",{className:"text-sm text-gray-500 mt-1 italic",children:t.metadata.pronunciation})]}),n.jsxs("div",{className:"relative mx-auto",style:{maxWidth:"500px"},children:[n.jsx("img",{src:y(),alt:"Bird for identification",className:"w-full rounded-lg shadow-md"}),l.map(w=>n.jsx("div",{style:f(w),onMouseEnter:()=>!s&&i(w.id),onMouseLeave:()=>!s&&i(null),onClick:()=>c(w.id),children:(o===w.id||r===w.id&&s)&&n.jsx("span",{className:"text-xs font-semibold text-gray-800 bg-white px-2 py-1 rounded shadow-sm",children:w.label})},w.id))]}),!s&&n.jsxs("div",{className:"flex justify-center space-x-4 text-sm",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-3 h-3 bg-blue-100 border-2 border-blue-500 rounded mr-2"}),n.jsx("span",{className:"text-gray-600",children:"Hover to explore"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-3 h-3 bg-green-100 border-2 border-green-500 rounded mr-2"}),n.jsx("span",{className:"text-gray-600",children:"Correct"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-3 h-3 bg-red-100 border-2 border-red-500 rounded mr-2"}),n.jsx("span",{className:"text-gray-600",children:"Incorrect"})]})]}),s&&r===h&&((S=t.metadata)==null?void 0:S.tip)&&n.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded",children:n.jsxs("p",{className:"text-sm text-blue-700",children:[n.jsx("strong",{children:"💡 Learning Tip:"})," ",t.metadata.tip]})})]})};class Re{constructor(e){J(this,"annotations",[]);J(this,"currentLevel",1);J(this,"exerciseHistory",[]);this.annotations=e}generateAdaptiveExercise(){const e=this.getExerciseTypesForLevel(this.currentLevel),s=this.selectNextExerciseType(e);return this.generateExercise(s)}getExerciseTypesForLevel(e){const s={1:["visual_identification","visual_discrimination"],2:["term_matching","audio_recognition","contextual_fill"],3:["sentence_building","cultural_context"]};return s[Math.min(e,3)]||s[1]}selectNextExerciseType(e){const s=e.filter(o=>!this.exerciseHistory.slice(-2).includes(o)),r=s.length>0?s:e,a=r[Math.floor(Math.random()*r.length)];return this.exerciseHistory.push(a),a}generateExercise(e){switch(e){case"visual_identification":return this.generateVisualIdentification();case"visual_discrimination":return this.generateEnhancedVisualDiscrimination();case"audio_recognition":return this.generateAudioRecognition();case"term_matching":return this.generateEnhancedTermMatching();case"contextual_fill":return this.generateEnhancedContextualFill();case"sentence_building":return this.generateSentenceBuilding();case"cultural_context":return this.generateCulturalContext();default:return null}}generateVisualIdentification(){const e=this.annotations.filter(a=>a.type==="anatomical");if(e.length===0)return null;const s=e[Math.floor(Math.random()*e.length)],r=s.imageId||"flamingo";return{id:`vi_${Date.now()}`,type:"visual_identification",prompt:s.spanishTerm,pedagogicalLevel:"recognition",learningObjective:"Identify bird anatomy parts in Spanish",instructions:"Click on the bird part",metadata:{bird:r,targetPart:this.mapTermToPart(s.spanishTerm),pronunciation:s.pronunciation,tip:`Remember: ${s.spanishTerm} means ${s.englishTerm} in English`},preTeaching:`Look at the bird image. You'll identify "${s.spanishTerm}" (${s.englishTerm}).`,scaffolding:["Look at the overall bird shape","Focus on the specific body parts",`Find the ${s.englishTerm}`]}}generateEnhancedVisualDiscrimination(){if(this.annotations.length<4)return null;const e=this.annotations.filter(i=>i.difficultyLevel===this.currentLevel),r=[...e.length>=4?e:this.annotations].sort(()=>Math.random()-.5),a=r[0],o=r.slice(1,4);return{id:`evd_${Date.now()}`,type:"visual_discrimination",prompt:a.spanishTerm,instructions:`Select the image that shows: "${a.spanishTerm}"`,pedagogicalLevel:"comprehension",learningObjective:"Match Spanish bird terms with visual representations",metadata:{correctId:a.id,options:[a,...o].map(i=>({id:i.id,term:i.spanishTerm,image:i.imageId,hint:i.englishTerm}))},preTeaching:`"${a.spanishTerm}" is pronounced "${a.pronunciation}"`,culturalNote:this.getCulturalNote(a.spanishTerm)}}generateAudioRecognition(){const e=this.annotations.filter(a=>a.pronunciation);if(e.length<4)return null;const s=e[Math.floor(Math.random()*e.length)],r=[s,...e.filter(a=>a.id!==s.id).slice(0,3)];return{id:`ar_${Date.now()}`,type:"audio_recognition",prompt:"Listen and select the correct word",instructions:"Which word do you hear?",pedagogicalLevel:"recognition",learningObjective:"Develop Spanish pronunciation recognition",metadata:{audioText:s.spanishTerm,pronunciation:s.pronunciation,options:r.map(a=>({id:a.id,text:a.spanishTerm,translation:a.englishTerm})),correctId:s.id},scaffolding:["Listen carefully to the pronunciation","Focus on syllable stress","Compare with similar-sounding words"]}}generateEnhancedTermMatching(){const e=this.groupAnnotationsByType(),s=Object.keys(e)[Math.floor(Math.random()*Object.keys(e).length)],r=e[s];if(r.length<4)return null;const a=r.slice(0,4);return{id:`etm_${Date.now()}`,type:"term_matching",prompt:"Match Spanish and English terms",instructions:`Match ${s} vocabulary`,pedagogicalLevel:"application",learningObjective:"Connect Spanish and English bird terminology",metadata:{pairs:a.map(o=>({spanish:o.spanishTerm,english:o.englishTerm,hint:o.pronunciation})),category:s},preTeaching:`These terms are all related to ${s} features`,scaffolding:["Look for cognates (similar words)","Use pronunciation as a memory aid","Group by meaning categories"]}}generateEnhancedContextualFill(){const e=this.annotations[Math.floor(Math.random()*this.annotations.length)],s=this.annotations.filter(o=>o.type===e.type&&o.id!==e.id);if(s.length<3)return null;const r=this.getContextSentences(e),a=r[Math.floor(Math.random()*r.length)];return{id:`ecf_${Date.now()}`,type:"contextual_fill",prompt:a.text.replace("___","_____"),instructions:"Complete the sentence",pedagogicalLevel:"application",learningObjective:"Use Spanish bird vocabulary in context",metadata:{correctAnswer:e.spanishTerm,options:[e,...s.slice(0,3)].map(o=>({text:o.spanishTerm,translation:o.englishTerm})),context:a.context,grammarNote:a.grammar},scaffolding:["Read the entire sentence first","Identify the missing word type","Consider gender and number agreement"],culturalNote:a.cultural}}generateSentenceBuilding(){const e=this.annotations[Math.floor(Math.random()*this.annotations.length)],s=[{template:"El [BIRD] tiene [FEATURE] [ADJECTIVE]",words:["El",e.imageId||"pájaro","tiene",e.spanishTerm,this.getAdjective()],translation:`The ${e.imageId||"bird"} has ${e.englishTerm} ${this.getAdjectiveTranslation()}`},{template:"[FEATURE] del [BIRD] es [COLOR]",words:[e.spanishTerm,"del",e.imageId||"pájaro","es",this.getColor()],translation:`The ${e.englishTerm} of the ${e.imageId||"bird"} is ${this.getColorTranslation()}`}],r=s[Math.floor(Math.random()*s.length)],a=[...r.words].sort(()=>Math.random()-.5);return{id:`sb_${Date.now()}`,type:"sentence_building",prompt:"Build a sentence",instructions:"Arrange the words to form a correct sentence",pedagogicalLevel:"synthesis",learningObjective:"Construct Spanish sentences about birds",metadata:{scrambledWords:a,correctOrder:r.words,translation:r.translation,template:r.template},scaffolding:["Identify the subject (bird)","Find the verb","Check adjective agreement","Verify word order"],preTeaching:"Spanish word order: Subject + Verb + Object"}}generateCulturalContext(){const e=[{question:"¿Por qué los flamencos son rosados?",options:["Por su dieta de camarones","Por el sol","Por el agua salada","Por sus genes"],correct:0,explanation:"Flamingos get their pink color from carotenoids in the shrimp and algae they eat.",cultural:"In Spanish culture, flamingos symbolize grace and beauty."},{question:"¿Dónde anidan las cigüeñas en España?",options:["En los árboles","En los campanarios de las iglesias","En las cuevas","En el suelo"],correct:1,explanation:"Storks traditionally nest on church bell towers in Spain.",cultural:"Stork nests on churches are considered good luck in Spanish villages."}],s=e[Math.floor(Math.random()*e.length)];return{id:`cc_${Date.now()}`,type:"cultural_context",prompt:s.question,instructions:"Answer the cultural question",pedagogicalLevel:"analysis",learningObjective:"Understand cultural connections to Spanish bird vocabulary",metadata:{options:s.options,correctIndex:s.correct,explanation:s.explanation},culturalNote:s.cultural,scaffolding:["Think about Spanish geography","Consider traditional practices","Remember cultural symbols"]}}mapTermToPart(e){return{"el pico":"beak","las patas":"legs","las alas":"wings","las garras":"talons","los ojos":"eyes","el cuello":"neck","las plumas":"feathers","la cola":"tail","el pecho":"breast"}[e]||"beak"}groupAnnotationsByType(){return this.annotations.reduce((e,s)=>{const r=s.type||"general";return e[r]||(e[r]=[]),e[r].push(s),e},{})}getContextSentences(e){return[{text:`El ___ del ${e.imageId||"pájaro"} es muy característico.`,context:"describing features",grammar:"Noun-adjective agreement",cultural:"Spanish descriptive language is rich and specific"},{text:`Mira cómo el ${e.imageId||"pájaro"} usa su ___ para comer.`,context:"observing behavior",grammar:'Possessive "su" (his/her/its)',cultural:"Birdwatching is popular in Spanish natural parks"},{text:"Los ___ son importantes para identificar esta especie.",context:"scientific identification",grammar:"Plural forms",cultural:"Spain has rich ornithological research traditions"}]}getCulturalNote(e){return{"el pico":'Expression: "Cerrar el pico" means to be quiet',"las patas":'Saying: "Meter la pata" means to make a mistake',"las alas":'Phrase: "Dar alas" means to encourage someone',"los ojos":'Expression: "Vista de águila" means sharp vision'}[e]||"Spanish has many bird-related expressions"}getAdjective(){const e=["grande","pequeño","largo","corto","fuerte","delicado"];return e[Math.floor(Math.random()*e.length)]}getAdjectiveTranslation(){return{grande:"large",pequeño:"small",largo:"long",corto:"short",fuerte:"strong",delicado:"delicate"}[this.getAdjective()]||"beautiful"}getColor(){const e=["rojo","azul","verde","amarillo","negro","blanco","gris","marrón"];return e[Math.floor(Math.random()*e.length)]}getColorTranslation(){return{rojo:"red",azul:"blue",verde:"green",amarillo:"yellow",negro:"black",blanco:"white",gris:"gray",marrón:"brown"}[this.getColor()]||"colorful"}updateLevel(e){const s=e.correct/e.total;s>.8&&this.currentLevel<3?this.currentLevel++:s<.5&&this.currentLevel>1&&this.currentLevel--}static checkAnswer(e,s){const r=e.metadata;if(!r)return!1;switch(e.type){case"visual_identification":return s===r.targetPart;case"visual_discrimination":return s===r.correctId;case"audio_recognition":return s===r.correctId;case"contextual_fill":return s===r.correctAnswer;case"sentence_building":return JSON.stringify(s)===JSON.stringify(r.correctOrder);case"cultural_context":return s===r.correctIndex;default:return!1}}static generateFeedback(e,s){if(e){const r=["¡Excelente! Excellent work!","¡Muy bien! Very good!","¡Perfecto! Perfect!","¡Fantástico! Fantastic!","¡Increíble! Amazing!"];return r[Math.floor(Math.random()*r.length)]}else{const r=s.metadata;let a="Not quite right. ";if(r)switch(s.type){case"visual_identification":a+=`Look for "${r.targetPart}"`;break;case"contextual_fill":a+=`The answer was: ${r.correctAnswer}`;break;case"cultural_context":a+=r.explanation||"Try again!";break;default:a+="Try again!"}return a}}}const Rr=({annotations:t})=>{const[e,s]=b.useState(null),[r]=b.useState(()=>new Re(t)),[a,o]=b.useState({sessionId:`session_${Date.now()}`,exercisesCompleted:0,correctAnswers:0,currentStreak:0,startedAt:new Date}),[i,d]=b.useState(!1),[p,h]=b.useState(null);b.useEffect(()=>{l()},[]);const l=()=>{const m=r.generateAdaptiveExercise();m&&(s(m),d(!1),h(null))},c=m=>{if(!e)return;const x=Re.checkAnswer(e,m),g=Re.generateFeedback(x,e),S={...a,exercisesCompleted:a.exercisesCompleted+1,correctAnswers:a.correctAnswers+(x?1:0),currentStreak:x?a.currentStreak+1:0};o(S),h({correct:x,feedback:g}),d(!0),r.updateLevel({correct:S.correctAnswers,total:S.exercisesCompleted}),setTimeout(()=>{l()},3e3)},f=()=>{if(!e)return null;const m=e.preTeaching&&!i?n.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-700",children:[n.jsx("strong",{children:"📚 Learning Tip:"})," ",e.preTeaching]}):null;let x=null;switch(e.type){case"visual_identification":x=n.jsx(Tr,{exercise:e,onAnswer:c,disabled:i});break;case"visual_discrimination":x=n.jsx(Cr,{exercise:e,onAnswer:c,disabled:i});break;case"contextual_fill":x=n.jsx(Ar,{exercise:e,onAnswer:c,disabled:i});break;default:x=n.jsxs("div",{className:"text-center py-8",children:[n.jsx("h3",{className:"text-xl font-semibold mb-4",children:e.prompt}),n.jsx("p",{className:"text-gray-600",children:e.instructions}),n.jsx("button",{onClick:()=>c(null),className:"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Continue"})]})}return n.jsxs(n.Fragment,{children:[m,x,e.culturalNote&&i&&n.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border-l-4 border-yellow-400 rounded",children:n.jsxs("p",{className:"text-sm text-yellow-700",children:[n.jsx("strong",{children:"🌍 Cultural Note:"})," ",e.culturalNote]})})]})},y=a.exercisesCompleted>0?Math.round(a.correctAnswers/a.exercisesCompleted*100):0;return n.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Practice Session"}),e&&n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Level: ",e.pedagogicalLevel," • Objective: ",e.learningObjective]})]}),n.jsx("button",{onClick:()=>l(),className:"text-sm text-blue-600 hover:text-blue-800",children:"Skip →"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.exercisesCompleted}),n.jsx("p",{className:"text-sm text-gray-500",children:"Completed"})]}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[y,"%"]}),n.jsx("p",{className:"text-sm text-gray-500",children:"Accuracy"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-2xl font-bold text-blue-600",children:a.currentStreak}),n.jsx("p",{className:"text-sm text-gray-500",children:"Streak"})]})]})]}),n.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:f()}),i&&p&&n.jsxs("div",{className:`mt-4 p-4 rounded-lg text-center transition-all ${p.correct?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[n.jsx("p",{className:"text-lg font-bold",children:p.feedback}),n.jsx("p",{className:"text-sm mt-1",children:"Next exercise loading..."})]})]})},kr=[{id:"1",imageId:"flamingo",boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:100,y:100},width:100,height:100},type:"anatomical",spanishTerm:"el pico",englishTerm:"beak",pronunciation:"el PEE-koh",difficultyLevel:1,isVisible:!0,createdAt:new Date,updatedAt:new Date},{id:"2",imageId:"flamingo",boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:100,y:100},width:100,height:100},type:"anatomical",spanishTerm:"las patas",englishTerm:"legs",pronunciation:"lahs PAH-tahs",difficultyLevel:1,isVisible:!0,createdAt:new Date,updatedAt:new Date},{id:"3",imageId:"sparrow",boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:100,y:100},width:100,height:100},type:"anatomical",spanishTerm:"las alas",englishTerm:"wings",pronunciation:"lahs AH-lahs",difficultyLevel:1,isVisible:!0,createdAt:new Date,updatedAt:new Date},{id:"4",imageId:"eagle",boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:100,y:100},width:100,height:100},type:"anatomical",spanishTerm:"los ojos",englishTerm:"eyes",pronunciation:"lohs OH-hohs",difficultyLevel:1,isVisible:!0,createdAt:new Date,updatedAt:new Date},{id:"5",imageId:"stork",boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:100,y:100},width:100,height:100},type:"habitat",spanishTerm:"el nido",englishTerm:"nest",pronunciation:"el NEE-doh",difficultyLevel:1,isVisible:!0,createdAt:new Date,updatedAt:new Date},{id:"6",imageId:"flamingo",boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:100,y:100},width:100,height:100},type:"color",spanishTerm:"las plumas rosadas",englishTerm:"pink feathers",pronunciation:"lahs PLOO-mahs roh-SAH-dahs",difficultyLevel:2,isVisible:!0,createdAt:new Date,updatedAt:new Date},{id:"7",imageId:"eagle",boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:100,y:100},width:100,height:100},type:"anatomical",spanishTerm:"las garras",englishTerm:"talons",pronunciation:"lahs GAH-rrahs",difficultyLevel:2,isVisible:!0,createdAt:new Date,updatedAt:new Date},{id:"8",imageId:"stork",boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:100,y:100},width:100,height:100},type:"anatomical",spanishTerm:"el cuello largo",englishTerm:"long neck",pronunciation:"el KWEH-yoh LAHR-goh",difficultyLevel:2,isVisible:!0,createdAt:new Date,updatedAt:new Date},{id:"9",imageId:"cardinal",boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:100,y:100},width:100,height:100},type:"anatomical",spanishTerm:"la cresta roja",englishTerm:"red crest",pronunciation:"lah KREHS-tah ROH-hah",difficultyLevel:2,isVisible:!0,createdAt:new Date,updatedAt:new Date},{id:"10",imageId:"owl",boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:100,y:100},width:100,height:100},type:"behavior",spanishTerm:"caza de noche",englishTerm:"hunts at night",pronunciation:"KAH-sah deh NOH-cheh",difficultyLevel:2,isVisible:!0,createdAt:new Date,updatedAt:new Date},{id:"11",imageId:"peacock",boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:100,y:100},width:100,height:100},type:"behavior",spanishTerm:"hacer la rueda",englishTerm:"display tail feathers",pronunciation:"ah-SEHR lah RWEH-dah",difficultyLevel:3,isVisible:!0,createdAt:new Date,updatedAt:new Date},{id:"12",imageId:"migratory",boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:100,y:100},width:100,height:100},type:"behavior",spanishTerm:"migrar al sur",englishTerm:"migrate south",pronunciation:"mee-GRAHR ahl soor",difficultyLevel:3,isVisible:!0,createdAt:new Date,updatedAt:new Date}],Lr=()=>n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Practice Exercises"}),n.jsx("p",{className:"text-gray-600 mb-8",children:"Test your Spanish bird vocabulary knowledge"}),n.jsx(Rr,{annotations:kr,onComplete:t=>{console.log("Session complete:",t)}})]})}),Or=({species:t,onClick:e,viewMode:s="grid"})=>{const r=o=>{switch(o){case"LC":return"bg-green-100 text-green-800";case"NT":return"bg-yellow-100 text-yellow-800";case"VU":return"bg-orange-100 text-orange-800";case"EN":return"bg-red-100 text-red-800";case"CR":return"bg-red-200 text-red-900";default:return"bg-gray-100 text-gray-800"}},a=o=>{switch(o){case"small":return"🐦";case"medium":return"🦅";case"large":return"🦢";default:return"🦜"}};return s==="list"?n.jsxs("div",{onClick:()=>e==null?void 0:e(t),className:"flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-200",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center text-2xl",children:a(t.sizeCategory)}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:t.spanishName}),n.jsx("p",{className:"text-sm text-gray-600",children:t.englishName}),n.jsx("p",{className:"text-xs text-gray-500 italic",children:t.scientificName})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-xs text-gray-500",children:t.familyName}),t.conservationStatus&&n.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r(t.conservationStatus)}`,children:t.conservationStatus})]}),n.jsx("div",{className:"flex gap-1",children:t.habitats.slice(0,2).map(o=>n.jsx("span",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded",children:o},o))})]}):n.jsxs("div",{onClick:()=>e==null?void 0:e(t),className:"bg-white rounded-lg shadow-md hover:shadow-xl transition-all cursor-pointer overflow-hidden group",children:[n.jsxs("div",{className:"aspect-square bg-gradient-to-br from-gray-200 to-gray-300 relative",children:[n.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-6xl opacity-50",children:a(t.sizeCategory)}),t.primaryImageUrl&&n.jsx("img",{src:t.primaryImageUrl,alt:t.spanishName,className:"w-full h-full object-cover",loading:"lazy"}),t.conservationStatus&&n.jsx("span",{className:`absolute top-2 right-2 text-xs px-2 py-1 rounded-full ${r(t.conservationStatus)}`,children:t.conservationStatus})]}),n.jsxs("div",{className:"p-4",children:[n.jsx("h3",{className:"font-bold text-gray-900 text-lg group-hover:text-blue-600 transition-colors",children:t.spanishName}),n.jsx("p",{className:"text-sm text-gray-600",children:t.englishName}),n.jsx("p",{className:"text-xs text-gray-500 italic mt-1",children:t.scientificName}),n.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[n.jsx("div",{className:"flex gap-1",children:t.primaryColors.slice(0,3).map(o=>n.jsx("span",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:o},title:o},o))}),n.jsx("span",{className:"text-xs text-gray-500",children:t.familyName})]}),n.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:t.habitats.slice(0,2).map(o=>n.jsx("span",{className:"text-xs bg-green-50 text-green-700 px-2 py-1 rounded",children:o},o))}),t.annotationCount!==void 0&&n.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:n.jsxs("p",{className:"text-xs text-gray-500",children:[t.annotationCount," annotations available"]})})]})]})},Pr=({filters:t,onFilterChange:e,availableFilters:s})=>{const r=(i,d)=>{e({...t,[i]:d||void 0})},a=()=>{e({})},o=Object.values(t).filter(i=>i).length;return n.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:"Filters"}),o>0&&n.jsxs("button",{onClick:a,className:"text-sm text-blue-600 hover:text-blue-800",children:["Clear all (",o,")"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),n.jsx("input",{type:"text",value:t.searchTerm||"",onChange:i=>r("searchTerm",i.target.value),placeholder:"Spanish or English name...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order"}),n.jsxs("select",{value:t.orderName||"",onChange:i=>r("orderName",i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Orders"}),s.orders.map(i=>n.jsx("option",{value:i,children:i},i))]})]}),t.orderName&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Family"}),n.jsxs("select",{value:t.familyName||"",onChange:i=>r("familyName",i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Families"}),s.families.map(i=>n.jsx("option",{value:i,children:i},i))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),n.jsx("div",{className:"flex gap-2",children:["small","medium","large"].map(i=>n.jsx("button",{onClick:()=>r("sizeCategory",t.sizeCategory===i?null:i),className:`flex-1 px-3 py-2 rounded-md border text-sm capitalize transition-colors ${t.sizeCategory===i?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:i},i))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Habitat"}),n.jsxs("select",{value:t.habitat||"",onChange:i=>r("habitat",i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Habitats"}),s.habitats.map(i=>n.jsx("option",{value:i,children:i},i))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Color"}),n.jsx("div",{className:"grid grid-cols-4 gap-2",children:s.colors.map(i=>n.jsx("button",{onClick:()=>r("primaryColor",t.primaryColor===i?null:i),className:`w-full h-8 rounded border-2 transition-all ${t.primaryColor===i?"border-blue-500 ring-2 ring-blue-200":"border-gray-300 hover:border-gray-400"}`,style:{backgroundColor:i},title:i},i))})]})]})},Dr=()=>{const[t,e]=b.useState([]),[s,r]=b.useState(!1),[a,o]=b.useState(null),i=b.useCallback(async l=>{r(!0),o(null);try{const c=await H.species.list(l);return e(c),c}catch(c){return o("Failed to load species"),console.error("Error fetching species:",c),e([]),[]}finally{r(!1)}},[]),d=b.useCallback(async l=>{try{return await H.species.get(l)}catch(c){return console.error("Error fetching species details:",c),null}},[]),p=b.useCallback(async l=>{try{const c=l.toLowerCase();return t.filter(y=>{var m,x,g;return((m=y.spanishName)==null?void 0:m.toLowerCase().includes(c))||((x=y.englishName)==null?void 0:x.toLowerCase().includes(c))||((g=y.scientificName)==null?void 0:g.toLowerCase().includes(c))})}catch(c){return console.error("Error searching species:",c),[]}},[t]),h=b.useCallback(()=>{const l={totalSpecies:t.length,byOrder:{},byHabitat:{},bySize:{}};return t.forEach(c=>{var f;c.orderName&&(l.byOrder[c.orderName]=(l.byOrder[c.orderName]||0)+1),(f=c.habitats)==null||f.forEach(y=>{l.byHabitat[y]=(l.byHabitat[y]||0)+1}),c.sizeCategory&&(l.bySize[c.sizeCategory]=(l.bySize[c.sizeCategory]||0)+1)}),l},[t]);return b.useEffect(()=>{H.utils.getMode()==="client"&&t.length===0&&i()},[]),{species:t,loading:s,error:a,fetchSpecies:i,fetchSpeciesById:d,searchSpecies:p,getSpeciesStats:h}},Ir=()=>{const{species:t,loading:e,error:s,fetchSpecies:r}=Dr(),[a,o]=b.useState({}),[i,d]=b.useState("grid");b.useEffect(()=>{r()},[]);const p=b.useMemo(()=>{let c=[...t];if(a.searchTerm){const f=a.searchTerm.toLowerCase();c=c.filter(y=>y.spanishName.toLowerCase().includes(f)||y.englishName.toLowerCase().includes(f)||y.scientificName.toLowerCase().includes(f))}return a.orderName&&(c=c.filter(f=>f.orderName===a.orderName)),a.familyName&&(c=c.filter(f=>f.familyName===a.familyName)),a.sizeCategory&&(c=c.filter(f=>f.sizeCategory===a.sizeCategory)),a.habitat&&(c=c.filter(f=>f.habitats.includes(a.habitat))),a.primaryColor&&(c=c.filter(f=>f.primaryColors.includes(a.primaryColor))),c},[t,a]),h=b.useMemo(()=>{const c=[...new Set(t.map(x=>x.orderName))].sort(),f=a.orderName?[...new Set(t.filter(x=>x.orderName===a.orderName).map(x=>x.familyName))].sort():[...new Set(t.map(x=>x.familyName))].sort(),y=[...new Set(t.flatMap(x=>x.habitats))].sort(),m=[...new Set(t.flatMap(x=>x.primaryColors))].sort();return{orders:c,families:f,habitats:y,colors:m}},[t,a.orderName]),l=c=>{console.log("Selected species:",c)};return e?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"text-gray-500",children:"Loading species..."})}):s?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsxs("div",{className:"text-red-500",children:["Error loading species: ",s]})}):n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Species Browser"}),n.jsxs("p",{className:"text-gray-600",children:["Explore ",t.length," bird species with Spanish vocabulary"]})]}),n.jsxs("div",{className:"flex gap-6",children:[n.jsx("div",{className:"w-64 flex-shrink-0",children:n.jsx(Pr,{filters:a,onFilterChange:o,availableFilters:h})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-4 flex items-center justify-between",children:[n.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",p.length," of ",t.length," species"]}),n.jsx("div",{className:"flex items-center gap-4",children:n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>d("grid"),className:`p-2 rounded ${i==="grid"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,"aria-label":"Grid view",children:n.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:n.jsx("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM13 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2h-2z"})})}),n.jsx("button",{onClick:()=>d("list"),className:`p-2 rounded ${i==="list"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,"aria-label":"List view",children:n.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:n.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})})]}),p.length===0?n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[n.jsx("p",{className:"text-gray-500",children:"No species found matching your filters."}),n.jsx("button",{onClick:()=>o({}),className:"mt-4 text-blue-600 hover:text-blue-800",children:"Clear filters"})]}):n.jsx("div",{className:i==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-4",children:p.map(c=>n.jsx(Or,{species:c,onClick:l,viewMode:i},c.id))})]})]})]})},_r=()=>n.jsx(Ir,{});function Mr(){return n.jsx(_t,{basename:"/",children:n.jsxs("div",{className:"min-h-screen",children:[n.jsx("nav",{className:"bg-white shadow-sm border-b",children:n.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:n.jsx("div",{className:"flex justify-between h-16",children:n.jsxs("div",{className:"flex",children:[n.jsxs(q,{to:"/",className:"flex items-center px-2 py-2 text-gray-900 hover:text-gray-700",children:[n.jsx("span",{className:"text-2xl mr-2",children:"🦅"}),n.jsx("span",{className:"font-bold text-xl",children:"Aves"})]}),n.jsxs("div",{className:"ml-6 flex space-x-4",children:[n.jsx(q,{to:"/learn",className:"inline-flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Learn"}),n.jsx(q,{to:"/practice",className:"inline-flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Practice"}),n.jsx(q,{to:"/species",className:"inline-flex items-center px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:"Species"})]})]})})})}),n.jsxs(Mt,{children:[n.jsx(he,{path:"/",element:n.jsx(vr,{})}),n.jsx(he,{path:"/learn",element:n.jsx(Er,{})}),n.jsx(he,{path:"/practice",element:n.jsx(Lr,{})}),n.jsx(he,{path:"/species",element:n.jsx(_r,{})})]})]})})}ke.createRoot(document.getElementById("root")).render(n.jsx(Bt.StrictMode,{children:n.jsx(Mr,{})}));

import{j as e,L as s}from"./react-vendor-DQuyXcEf.js";import{a as t,B as a,C as r,c as i,b as n}from"./Badge-DuILK2iM.js";import{u as l}from"./data-vendor-CMzD5k4W.js";import{e as c}from"./index-BgNPggoK.js";import{u as d}from"./useSupabaseAuth-CqgoJLqK.js";import"./vendor-Sp3tVij8.js";const x={all:["ml-analytics"],overview:()=>[...x.all,"overview"],vocabularyBalance:()=>[...x.all,"vocabulary-balance"],patternLearning:()=>[...x.all,"pattern-learning"],qualityTrends:()=>[...x.all,"quality-trends"],performanceMetrics:()=>[...x.all,"performance-metrics"]},m=()=>{const{data:s,isLoading:d}=l({queryKey:x.overview(),queryFn:async()=>{try{return(await t.get("/api/ml/analytics/overview")).data}catch(e){throw c("Error fetching ML overview:",e instanceof Error?e:new Error(String(e))),e}},staleTime:12e4,gcTime:6e5,retry:2}),{data:m,isLoading:o}=l({queryKey:x.vocabularyBalance(),queryFn:async()=>{try{return(await t.get("/api/ml/analytics/vocabulary-balance")).data}catch(e){throw c("Error fetching vocabulary balance:",e instanceof Error?e:new Error(String(e))),e}},staleTime:3e5,gcTime:9e5,retry:2}),{data:h,isLoading:g}=l({queryKey:x.patternLearning(),queryFn:async()=>{try{return(await t.get("/api/ml/analytics/pattern-learning")).data}catch(e){throw c("Error fetching pattern learning:",e instanceof Error?e:new Error(String(e))),e}},staleTime:18e4,gcTime:6e5,retry:2}),{data:p,isLoading:y}=l({queryKey:x.qualityTrends(),queryFn:async()=>{try{return(await t.get("/api/ml/analytics/quality-trends")).data}catch(e){throw c("Error fetching quality trends:",e instanceof Error?e:new Error(String(e))),e}},staleTime:3e5,gcTime:9e5,retry:2}),{data:u,isLoading:j}=l({queryKey:x.performanceMetrics(),queryFn:async()=>{try{return(await t.get("/api/ml/analytics/performance-metrics")).data}catch(e){throw c("Error fetching performance metrics:",e instanceof Error?e:new Error(String(e))),e}},staleTime:12e4,gcTime:6e5,retry:2});return d||o||g||y||j?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading ML analytics..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"ML Optimization Dashboard"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Pattern learning, vocabulary balance, and quality improvements"})]}),e.jsx(a,{variant:"active"===h?.learningStatus?"success":"warning",size:"lg",children:"active"===h?.learningStatus?"üß† Learning Active":"‚è≥ Initializing"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(r,{variant:"elevated",children:e.jsx(i,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Learned Patterns"}),e.jsx("p",{className:"text-4xl font-bold text-purple-600",children:s?.patternLearning.totalPatterns||0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Across ",s?.patternLearning.speciesTracked||0," species"]})]})})}),e.jsx(r,{variant:"elevated",children:e.jsx(i,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Quality Improvement"}),e.jsx("p",{className:"text-4xl font-bold "+(s?.qualityMetrics.improvement.startsWith("+")?"text-green-600":"text-gray-600"),children:s?.qualityMetrics.improvement||"0%"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Recent vs Historical"})]})})}),e.jsx(r,{variant:"elevated",children:e.jsx(i,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Vocab Coverage"}),e.jsxs("p",{className:"text-4xl font-bold text-blue-600",children:[m?.coverage||0,"%"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[m?.totalFeatures||0," features tracked"]})]})})}),e.jsx(r,{variant:"elevated",children:e.jsx(i,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Throughput"}),e.jsx("p",{className:"text-4xl font-bold text-orange-600",children:(u?.pipeline?.throughput||0).toFixed(2)}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"images/second"})]})})})]}),h&&h.topPatterns.length>0&&e.jsxs(r,{variant:"elevated",children:[e.jsx(n,{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Learned Patterns"})}),e.jsx(i,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:h.topPatterns.slice(0,6).map((s,t)=>e.jsxs("div",{className:"border-2 rounded-lg p-4 "+("high"===s.reliability?"border-green-300 bg-green-50":"medium"===s.reliability?"border-yellow-300 bg-yellow-50":"border-gray-300 bg-gray-50"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:s.feature}),e.jsxs(a,{variant:"high"===s.reliability?"success":"medium"===s.reliability?"warning":"default",size:"sm",children:[(100*s.confidence).toFixed(0),"%"]})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:[s.observations," observations"]})]},t))})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[m&&m.topGaps&&m.topGaps.length>0&&e.jsxs(r,{variant:"elevated",children:[e.jsx(n,{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Vocabulary Gaps"})}),e.jsxs(i,{children:[e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:m.topGaps.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-yellow-50 border border-yellow-200 rounded hover:bg-yellow-100 transition-colors",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s}),e.jsx(a,{variant:"warning",size:"sm",children:"Missing"})]},t))}),e.jsx("p",{className:"text-xs text-gray-600 mt-3",children:"üí° Run ML-optimized pipeline to target these features"})]})]}),p&&p.summary&&e.jsxs(r,{variant:"elevated",children:[e.jsx(n,{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quality Trend"})}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Current Quality"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[(100*(p.summary.currentQuality||0)).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Improvement"}),e.jsxs("span",{className:"text-xl font-bold "+(Number(p.summary.improvement||0)>0?"text-green-600":"text-gray-600"),children:[Number(p.summary.improvement||0)>0?"+":"",p.summary.improvement||0,"%"]})]}),p.summary.totalWeeks&&e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-xs text-gray-600",children:["üìà Tracking ",p.summary.totalWeeks," weeks of data"]})})]})})]})]}),u&&"active"===u.status?.pipelineStatus&&u.pipeline&&e.jsxs(r,{variant:"elevated",children:[e.jsx(n,{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pipeline Performance"})}),e.jsxs(i,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"P50 Latency"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[((u.pipeline.p50Duration||0)/1e3).toFixed(1),"s"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"P95 Latency"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[((u.pipeline.p95Duration||0)/1e3).toFixed(1),"s"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Success Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[u.pipeline.successRate||0,"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Concurrency"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[u.pipeline.concurrency||1,"x"]})]})]}),u.status?.lastRun&&e.jsxs("p",{className:"text-xs text-gray-600 mt-4 text-center",children:["Last run: ",new Date(u.status.lastRun).toLocaleString()]})]})]}),h&&h.speciesInsights.length>0&&e.jsxs(r,{variant:"elevated",children:[e.jsx(n,{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Species-Specific Recommendations"})}),e.jsx(i,{children:e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:h.speciesInsights.slice(0,8).map((s,t)=>e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:s.species}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(a,{variant:"info",size:"sm",children:[s.annotations," annotations"]}),e.jsxs(a,{variant:"default",size:"sm",children:[s.features," features"]})]})]}),s.recommendedFeatures.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Recommended features:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.recommendedFeatures.map((s,t)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:s},t))})]})]},t))})})]})]})},o=()=>{const{user:t,loading:a}=d();return a?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading ML analytics..."})]})}):t?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"ML Analytics Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Pattern learning, vocabulary balance, and quality optimization insights"})]}),e.jsx(s,{to:"/admin/annotations",className:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"‚Üê Back to Annotations"})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsx(m,{})})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Authentication Required"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Please sign in to access ML analytics."}),e.jsx(s,{to:"/login",className:"inline-block bg-purple-600 hover:bg-purple-700 text-white font-medium py-2 px-6 rounded-md",children:"Sign In"})]})})};export{o as MLAnalyticsPage,o as default};

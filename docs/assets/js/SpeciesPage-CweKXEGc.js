import{r as e,j as s,e as a}from"./react-vendor-8XroUam3.js";import{u as r}from"./data-vendor-CmJkK5PS.js";import{a as t}from"./apiAdapter-BrhxuEAR.js";import{q as l,e as i,d as n}from"./index-Dy1s47gK.js";import"./vendor-Dmsy3jl6.js";const o=({src:a,alt:r,className:t="",placeholder:l,blurAmount:i=20,threshold:n=.01,rootMargin:o="50px",onLoad:c,onError:d})=>{const[m,x]=e.useState(!1),[h,u]=e.useState(!1),[g,p]=e.useState(!1),b=e.useRef(null);e.useEffect(()=>{if(!b.current)return;const e=new IntersectionObserver(s=>{s.forEach(s=>{s.isIntersecting&&(u(!0),e.disconnect())})},{threshold:n,rootMargin:o});return e.observe(b.current),()=>{e.disconnect()}},[n,o]);return s.jsxs("div",{ref:b,className:`relative overflow-hidden ${t}`,style:{backgroundColor:"#e5e7eb"},children:[s.jsx("img",{src:l||"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 300'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:rgb(229,231,235);stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:rgb(209,213,219);stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='400' height='300' fill='url(%23grad)' /%3E%3C/svg%3E",alt:"","aria-hidden":"true",className:"absolute inset-0 w-full h-full object-cover transition-opacity duration-500 "+(m?"opacity-0":"opacity-100"),style:{filter:`blur(${i}px)`,transform:"scale(1.1)"}}),h&&!g&&s.jsx("img",{src:a,alt:r,onLoad:()=>{x(!0),c?.()},onError:()=>{p(!0),d?.()},crossOrigin:"anonymous",className:"relative w-full h-full object-cover transition-opacity duration-500 "+(m?"opacity-100":"opacity-0"),loading:"lazy"}),g&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-200",children:s.jsxs("div",{className:"text-center text-gray-500",children:[s.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),s.jsx("span",{className:"text-sm",children:"Image unavailable"})]})}),h&&!m&&!g&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]})},c=a.memo(({species:e,onClick:a,viewMode:r="grid"})=>{const t=e=>{switch(e){case"LC":return"bg-green-100 text-green-800";case"NT":return"bg-yellow-100 text-yellow-800";case"VU":return"bg-orange-100 text-orange-800";case"EN":return"bg-red-100 text-red-800";case"CR":return"bg-red-200 text-red-900";default:return"bg-gray-100 text-gray-800"}},l=e=>{switch(e){case"small":return"🐦";case"medium":return"🦅";case"large":return"🦢";default:return"🦜"}};return"list"===r?s.jsxs("div",{onClick:()=>a?.(e),className:"flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-200",children:[e.primaryImageUrl?s.jsx(o,{src:e.primaryImageUrl,alt:e.spanishName,className:"w-16 h-16 rounded-lg",blurAmount:10}):s.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center text-2xl",children:l(e.sizeCategory)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:e.spanishName}),s.jsx("p",{className:"text-sm text-gray-600",children:e.englishName}),s.jsx("p",{className:"text-xs text-gray-500 italic",children:e.scientificName})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-gray-500",children:e.familyName}),e.conservationStatus&&s.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t(e.conservationStatus)}`,children:e.conservationStatus})]}),s.jsx("div",{className:"flex gap-1",children:e.habitats.slice(0,2).map(e=>s.jsx("span",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded",children:e},e))})]}):s.jsxs("div",{onClick:()=>a?.(e),className:"bg-white rounded-lg shadow-md hover:shadow-xl transition-all cursor-pointer overflow-hidden group",children:[s.jsxs("div",{className:"aspect-square bg-gradient-to-br from-gray-200 to-gray-300 relative",children:[e.primaryImageUrl?s.jsx(o,{src:e.primaryImageUrl,alt:e.spanishName,className:"w-full h-full"}):s.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-6xl opacity-50",children:l(e.sizeCategory)}),e.conservationStatus&&s.jsx("span",{className:`absolute top-2 right-2 text-xs px-2 py-1 rounded-full ${t(e.conservationStatus)}`,children:e.conservationStatus})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"font-bold text-gray-900 text-lg group-hover:text-blue-600 transition-colors",children:e.spanishName}),s.jsx("p",{className:"text-sm text-gray-600",children:e.englishName}),s.jsx("p",{className:"text-xs text-gray-500 italic mt-1",children:e.scientificName}),s.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[s.jsx("div",{className:"flex gap-1",children:e.primaryColors.slice(0,3).map(e=>s.jsx("span",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:e},title:e},e))}),s.jsx("span",{className:"text-xs text-gray-500",children:e.familyName})]}),s.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:e.habitats.slice(0,2).map(e=>s.jsx("span",{className:"text-xs bg-green-50 text-green-700 px-2 py-1 rounded",children:e},e))}),void 0!==e.annotationCount&&s.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:s.jsxs("p",{className:"text-xs text-gray-500",children:[e.annotationCount," annotations available"]})})]})]})}),d=({filters:e,onFilterChange:a,availableFilters:r})=>{const t=(s,r)=>{a({...e,[s]:r||void 0})},l=Object.values(e).filter(e=>e).length;return s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Filters"}),l>0&&s.jsxs("button",{onClick:()=>{a({})},className:"text-sm text-blue-600 hover:text-blue-800",children:["Clear all (",l,")"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),s.jsx("input",{type:"text",value:e.searchTerm||"",onChange:e=>t("searchTerm",e.target.value),placeholder:"Spanish or English name...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order"}),s.jsxs("select",{value:e.orderName||"",onChange:e=>t("orderName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"All Orders"}),r.orders.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),e.orderName&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Family"}),s.jsxs("select",{value:e.familyName||"",onChange:e=>t("familyName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"All Families"}),r.families.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),s.jsx("div",{className:"flex gap-2",children:["small","medium","large"].map(a=>s.jsx("button",{onClick:()=>t("sizeCategory",e.sizeCategory===a?null:a),className:"flex-1 px-3 py-2 rounded-md border text-sm capitalize transition-colors "+(e.sizeCategory===a?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:a},a))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Habitat"}),s.jsxs("select",{value:e.habitat||"",onChange:e=>t("habitat",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"All Habitats"}),r.habitats.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Color"}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:r.colors.map(a=>s.jsx("button",{onClick:()=>t("primaryColor",e.primaryColor===a?null:a),className:"w-full h-8 rounded border-2 transition-all "+(e.primaryColor===a?"border-blue-500 ring-2 ring-blue-200":"border-gray-300 hover:border-gray-400"),style:{backgroundColor:a},title:a},a))})]})]})},m=e=>r({queryKey:l.species.list(e),queryFn:async()=>{try{return await t.species.list(e)}catch(s){return i("Error fetching species",s instanceof Error?s:new Error(String(s))),[]}},staleTime:6e5,gcTime:18e5,placeholderData:[]}),x=()=>{const{data:a=[],isLoading:r,error:t}=m(),[l,i]=e.useState({}),[o,x]=e.useState("grid"),h=e.useMemo(()=>{let e=[...a];if(l.searchTerm){const s=l.searchTerm.toLowerCase();e=e.filter(e=>e.spanishName.toLowerCase().includes(s)||e.englishName.toLowerCase().includes(s)||e.scientificName.toLowerCase().includes(s))}return l.orderName&&(e=e.filter(e=>e.orderName===l.orderName)),l.familyName&&(e=e.filter(e=>e.familyName===l.familyName)),l.sizeCategory&&(e=e.filter(e=>e.sizeCategory===l.sizeCategory)),l.habitat&&(e=e.filter(e=>e.habitats.includes(l.habitat))),l.primaryColor&&(e=e.filter(e=>e.primaryColors.includes(l.primaryColor))),e},[a,l]),u=e.useMemo(()=>({orders:[...new Set(a.map(e=>e.orderName))].sort(),families:l.orderName?[...new Set(a.filter(e=>e.orderName===l.orderName).map(e=>e.familyName))].sort():[...new Set(a.map(e=>e.familyName))].sort(),habitats:[...new Set(a.flatMap(e=>e.habitats))].sort(),colors:[...new Set(a.flatMap(e=>e.primaryColors))].sort()}),[a,l.orderName]),g=e.useCallback(e=>{n("Selected species:",{name:e.spanishName})},[]),p=e.useCallback(e=>{i(e)},[]),b=e.useCallback(e=>{x(e)},[]),f=e.useCallback(()=>{i({})},[]);return r?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Loading species..."})}):t?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-red-500",children:["Error loading species: ",t instanceof Error?t.message:"Unknown error"]})}):s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Species Browser"}),s.jsxs("p",{className:"text-gray-600",children:["Explore ",a.length," bird species with Spanish vocabulary"]})]}),s.jsxs("div",{className:"flex gap-6",children:[s.jsx("div",{className:"w-64 flex-shrink-0",children:s.jsx(d,{filters:l,onFilterChange:p,availableFilters:u})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-4 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",h.length," of ",a.length," species"]}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:()=>b("grid"),className:"p-2 rounded "+("grid"===o?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),"aria-label":"Grid view",children:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM13 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2h-2z"})})}),s.jsx("button",{onClick:()=>b("list"),className:"p-2 rounded "+("list"===o?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),"aria-label":"List view",children:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})})]}),0===h.length?s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[s.jsx("p",{className:"text-gray-500",children:"No species found matching your filters."}),s.jsx("button",{onClick:f,className:"mt-4 text-blue-600 hover:text-blue-800",children:"Clear filters"})]}):s.jsx("div",{className:"grid"===o?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-4",children:h.map(e=>s.jsx(c,{species:e,onClick:g,viewMode:o},e.id))})]})]})]})},h=()=>s.jsx(x,{});export{h as SpeciesPage};

import{j as e,f as t,r as s,L as a}from"./react-vendor-D6vaw4E_.js";import{u as i,a as l}from"./useSpacedRepetition-2HlXaz1F.js";import{u as r}from"./useSpecies-qoKZee_J.js";import{a as n}from"./apiAdapter-4y4I9PLQ.js";import{e as o,w as c}from"./index-BgZ62Jpe.js";import"./vendor-BKIB45Nt.js";import"./data-vendor-CRo3OXJP.js";const d=({score:t,accuracy:s,streak:a,totalAttempts:i,srsStats:l,isRecording:r})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t}),e.jsx("p",{className:"text-sm text-gray-600",children:"Correct"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[s,"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Accuracy"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:a}),e.jsx("p",{className:"text-sm text-gray-600",children:"Streak"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:i}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total"})]})]}),l&&e.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-semibold text-indigo-700",children:l.mastered}),e.jsx("p",{className:"text-xs text-gray-600",children:"Mastered"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-semibold text-amber-600",children:l.learning}),e.jsx("p",{className:"text-xs text-gray-600",children:"Learning"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-semibold text-rose-600",children:l.dueForReview}),e.jsx("p",{className:"text-xs text-gray-600",children:"Due"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r&&e.jsx("span",{className:"inline-block w-2 h-2 bg-green-500 rounded-full animate-pulse",title:"Syncing progress..."}),e.jsxs("p",{className:"text-sm font-medium text-gray-700",children:[Math.round(100*l.averageMastery),"% Mastery"]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[l.totalTerms," terms tracked"]})]})]})})]}),m=({type:t,question:s,imageUrl:a,translation:i,options:l,selectedAnswer:r,correctAnswer:n,showFeedback:o,explanation:c,onAnswer:d})=>{const m=e=>o&&e===n?"bg-green-500 text-white":o&&e===r&&e!==n?"bg-red-500 text-white":r===e?"bg-blue-500 text-white":"bg-white border-2 border-gray-300 hover:border-blue-400";return"visual_match"===t?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-center",children:s}),e.jsx("div",{className:"relative w-full max-w-md mx-auto",children:a?e.jsx("img",{src:a,alt:"Bird to identify",className:"w-full rounded-lg shadow-md object-cover aspect-video bg-gray-100",onError:e=>{const t=e.target;t.onerror=null,t.src="https://images.unsplash.com/photo-1444464666168-49d633b86797?w=400&h=300&fit=crop&q=80"},loading:"lazy"}):e.jsx("div",{className:"w-full aspect-video bg-gradient-to-br from-blue-100 to-green-100 rounded-lg shadow-md flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-sm",children:"Image loading..."})]})})}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:l.map(t=>e.jsx("button",{onClick:()=>!o&&d(t),disabled:o,className:`p-4 rounded-lg font-medium transition-all ${m(t)}`,children:t},t))})]}):"fill_blank"===t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-2",children:s}),i&&e.jsx("p",{className:"text-gray-600 italic",children:i})]}),a&&e.jsx("div",{className:"relative w-full max-w-sm mx-auto",children:e.jsx("img",{src:a,alt:"Bird reference",className:"w-full rounded-lg shadow-md object-cover aspect-square",onError:e=>{e.target.style.display="none"},loading:"lazy"})}),e.jsx("div",{className:"grid grid-cols-2 gap-3 max-w-md mx-auto",children:l.map(t=>e.jsx("button",{onClick:()=>!o&&d(t),disabled:o,className:`p-3 rounded-lg font-medium transition-all ${m(t)}`,children:t},t))})]}):"multiple_choice"===t?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-2xl font-semibold text-center",children:s}),a&&e.jsx("div",{className:"relative w-full max-w-sm mx-auto",children:e.jsx("img",{src:a,alt:"Bird reference",className:"w-full rounded-lg shadow-md object-cover aspect-square",onError:e=>{e.target.style.display="none"},loading:"lazy"})}),e.jsx("div",{className:"space-y-3 max-w-md mx-auto",children:l.map(t=>e.jsx("button",{onClick:()=>!o&&d(t),disabled:o,className:`w-full p-4 text-left rounded-lg font-medium transition-all ${m(t)}`,children:t},t))}),o&&c&&e.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg text-center",children:e.jsx("p",{className:"text-sm text-blue-700",children:c})})]}):null},h=({isCorrect:t,correctAnswer:s})=>e.jsx("div",{className:"mt-6 p-4 rounded-lg text-center "+(t?"bg-green-100":"bg-red-100"),children:e.jsx("p",{className:"text-lg font-bold "+(t?"text-green-700":"text-red-700"),children:t?"Â¡Excelente! Correct!":`Not quite. The answer was: ${s}`})}),x=({title:t,description:s,icon:a,badge:i,badgeColor:l="bg-blue-600",isSelected:r,onClick:n})=>e.jsx("button",{onClick:n,className:"w-full p-4 rounded-lg border-2 text-left transition-all "+(r?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg "+(r?"bg-blue-600 text-white":"bg-gray-100 text-gray-600"),children:a}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t}),void 0!==i&&e.jsx("span",{className:`px-2 py-0.5 text-xs font-bold text-white rounded-full ${l}`,children:i})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s})]})]})}),g=({selectedMode:t,onModeSelect:s,selectedSpeciesId:a,onSpeciesSelect:l,selectedDifficulty:n,onDifficultySelect:o,selectedType:c,onTypeSelect:d})=>{const{data:m}=i(),{data:h=[]}=r(),g=m?.dueForReview||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Choose Practice Mode"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(x,{title:"Review Due",description:"Practice terms scheduled for review by spaced repetition",badge:g>0?g:void 0,badgeColor:g>0?"bg-red-500":"bg-gray-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),isSelected:"review"===t,onClick:()=>s("review")}),e.jsx(x,{title:"Quick Quiz",description:"Random mix of 10 exercises across all content",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),isSelected:"quick"===t,onClick:()=>s("quick")}),e.jsx(x,{title:"By Species",description:"Focus on vocabulary for a specific bird species",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14"})}),isSelected:"species"===t,onClick:()=>s("species")}),e.jsx(x,{title:"By Difficulty",description:"Choose exercises matching your skill level",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),isSelected:"difficulty"===t,onClick:()=>s("difficulty")}),e.jsx(x,{title:"By Exercise Type",description:"Practice specific exercise formats",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),isSelected:"type"===t,onClick:()=>s("type")})]})]}),"species"===t&&l&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Select Species"}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:h.filter(e=>e.annotationCount&&e.annotationCount>0).map(t=>e.jsxs("button",{onClick:()=>l(t.id),className:"p-2 text-sm rounded-lg text-left transition-colors "+(a===t.id?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-50 hover:bg-gray-100 text-gray-700"),children:[e.jsx("span",{className:"font-medium truncate block",children:t.spanishName}),e.jsxs("span",{className:"text-xs text-gray-500",children:[t.annotationCount," terms"]})]},t.id))})})]}),"difficulty"===t&&o&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Select Difficulty"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{level:1,label:"Beginner",color:"bg-green-500"},{level:2,label:"Elementary",color:"bg-blue-500"},{level:3,label:"Intermediate",color:"bg-yellow-500"},{level:4,label:"Advanced",color:"bg-orange-500"},{level:5,label:"Expert",color:"bg-red-500"}].map(t=>e.jsx("button",{onClick:()=>o(t.level),className:"px-4 py-2 rounded-lg font-medium transition-colors "+(n===t.level?`${t.color} text-white`:"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:t.label},t.level))})]}),"type"===t&&d&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Select Exercise Type"}),e.jsx("div",{className:"space-y-2",children:[{id:"visual_match",label:"Visual Match",description:"Identify birds from images"},{id:"fill_blank",label:"Fill in the Blank",description:"Complete sentences"},{id:"multiple_choice",label:"Multiple Choice",description:"Choose correct answer"},{id:"listening",label:"Listening",description:"Audio recognition"}].map(t=>e.jsxs("button",{onClick:()=>d(t.id),className:"w-full p-3 rounded-lg text-left transition-colors "+(c===t.id?"bg-blue-100 border-2 border-blue-300":"bg-gray-50 hover:bg-gray-100 border-2 border-transparent"),children:[e.jsx("span",{className:"font-medium text-gray-900",children:t.label}),e.jsx("span",{className:"text-sm text-gray-600 ml-2",children:t.description})]},t.id))})]}),m&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:m.totalTerms}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Terms"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:m.mastered}),e.jsx("div",{className:"text-xs text-gray-600",children:"Mastered"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m.learning}),e.jsx("div",{className:"text-xs text-gray-600",children:"Learning"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:m.streak}),e.jsx("div",{className:"text-xs text-gray-600",children:"Day Streak"})]})]})})]})};const p=new class{speciesCache=[];lastFetch=0;cacheDuration=3e5;isLikelySpanish(e){if(!e)return!1;const t=[/[Ã¡Ã©Ã­Ã³ÃºÃ¼Ã±]/i,/^(el|la|los|las)\s/i,/(illo|illa|ito|ita|Ã³n|ado|ido|ero|era|oso|osa)$/i,/\s(de|del|comÃºn|real|grande|pequeÃ±o|azul|rojo|negro|blanco|pardo|gris)/i],s=[/\b(owl|hawk|eagle|duck|goose|sparrow|robin|crow|jay|finch|warbler|wren|thrush|swallow|heron|egret|ibis|pelican|gull|tern|dove|pigeon|woodpecker|kingfisher|hummingbird)\b/i,/^[A-Z][a-z]+\s[A-Z][a-z]+$/];for(const a of t)if(a.test(e))return!0;for(const a of s)if(a.test(e))return!1;return e.length>3}getDisplayName(e){return this.isLikelySpanish(e.spanishName)?e.spanishName:e.spanishName||e.englishName}async getSpeciesWithImages(){const e=Date.now();if(this.speciesCache.length>0&&e-this.lastFetch<this.cacheDuration)return this.speciesCache;try{const t=await n.species.list();return this.speciesCache=t.filter(e=>e.annotationCount&&e.annotationCount>0||e.primaryImageUrl),this.lastFetch=e,this.speciesCache}catch(t){return o("Failed to fetch species",t instanceof Error?t:{error:t}),this.speciesCache}}async getRandomSpecies(e){const t=await this.getSpeciesWithImages();if(0===t.length)return[];const s=[...t].sort(()=>Math.random()-.5);return s.slice(0,Math.min(e,s.length))}async generateVisualMatchExercises(e=10){const t=[],s=await this.getRandomSpecies(4*e);if(s.length<4)return c("Not enough species for visual match exercises",{found:s.length,needed:4}),[];const a=s.filter(e=>e.primaryImageUrl||e.annotationCount&&e.annotationCount>0);a.length<4&&c("Not enough species WITH IMAGES for visual match",{found:a.length});const i=a.length>=4?a:s;for(let l=0;l<Math.min(e,Math.floor(i.length/4));l++){const e=i[4*l],s=i.slice(4*l+1,4*l+4),a=this.getDisplayName(e),r=[a,...s.map(e=>this.getDisplayName(e))].sort(()=>Math.random()-.5),n=this.getImageUrl(e);t.push({id:`visual_match_${l}_${Date.now()}`,type:"visual_match",question:"Â¿QuÃ© pÃ¡jaro es este? (What bird is this?)",correctAnswer:a,options:r,imageUrl:n,speciesId:e.id,explanation:`${e.spanishName} - ${e.englishName}`})}return t}async generateFillBlankExercises(e=10){const t=[],s=await this.getRandomSpecies(4*e);if(s.length<4)return c("Not enough species for fill-blank exercises",{found:s.length,needed:4}),[];const a=[{es:"El {BLANK} vive en {CONTEXT}.",en:"The {BLANK} lives in {CONTEXT}.",getBlank:e=>this.getDisplayName(e).toLowerCase(),getContext:e=>e.habitats?.[0]||"bosques"},{es:"El {BLANK} es de color {CONTEXT}.",en:"The {BLANK} is {CONTEXT} colored.",getBlank:e=>this.getDisplayName(e).toLowerCase(),getContext:e=>e.primaryColors?.[0]||"variado"},{es:"El {BLANK} pertenece a la familia {CONTEXT}.",en:"The {BLANK} belongs to the {CONTEXT} family.",getBlank:e=>this.getDisplayName(e).toLowerCase(),getContext:e=>e.familyName||"desconocida"}];for(let i=0;i<Math.min(e,Math.floor(s.length/4));i++){const e=s[4*i],l=a[i%a.length],r=s.slice(4*i+1,4*i+4),n=l.es.replace("{CONTEXT}",l.getContext(e)).replace("{BLANK}","___"),o=l.en.replace("{CONTEXT}",l.getContext(e)).replace("{BLANK}","___"),c=[l.getBlank(e),...r.map(e=>l.getBlank(e))].sort(()=>Math.random()-.5);t.push({id:`fill_blank_${i}_${Date.now()}`,type:"fill_blank",question:n,correctAnswer:l.getBlank(e),options:c,translation:o,speciesId:e.id,imageUrl:this.getImageUrl(e)})}return t}async generateMultipleChoiceExercises(e=10){const t=[],s=await this.getRandomSpecies(4*e);if(s.length<4)return c("Not enough species for multiple choice exercises",{found:s.length,needed:4}),[];const a=[{question:e=>`Â¿DÃ³nde vive el ${this.getDisplayName(e)}?`,getCorrect:e=>e.habitats?.[0]||"bosques",getOptions:(e,t)=>[e,t[0]?.habitats?.[0]||"montaÃ±as",t[1]?.habitats?.[0]||"rÃ­os",t[2]?.habitats?.[0]||"costas"],explanation:e=>`El ${this.getDisplayName(e)} vive en ${e.habitats?.[0]||"varios hÃ¡bitats"}`},{question:e=>`Â¿De quÃ© color es el ${this.getDisplayName(e)}?`,getCorrect:e=>e.primaryColors?.[0]||"variado",getOptions:(e,t)=>[e,t[0]?.primaryColors?.[0]||"rojo",t[1]?.primaryColors?.[0]||"azul",t[2]?.primaryColors?.[0]||"verde"],explanation:e=>`El ${this.getDisplayName(e)} tiene plumaje ${e.primaryColors?.join(" y ")||"variado"}`},{question:e=>`Â¿A quÃ© familia pertenece el ${this.getDisplayName(e)}?`,getCorrect:e=>e.familyName,getOptions:(e,t)=>[e,...t.map(e=>e.familyName).filter(t=>t!==e).slice(0,3)],explanation:e=>`El ${this.getDisplayName(e)} es de la familia ${e.familyName}`}];for(let i=0;i<Math.min(e,Math.floor(s.length/4));i++){const e=s[4*i],l=s.slice(4*i+1,4*i+4),r=a[i%a.length],n=r.getCorrect(e),o=r.getOptions(n,l).filter((e,t,s)=>s.indexOf(e)===t).slice(0,4).sort(()=>Math.random()-.5);t.push({id:`multiple_choice_${i}_${Date.now()}`,type:"multiple_choice",question:r.question(e),correctAnswer:n,options:o,explanation:r.explanation(e),speciesId:e.id,imageUrl:this.getImageUrl(e)})}return t}async generateMixedExercises(e=30){const t=Math.ceil(e/3),[s,a,i]=await Promise.all([this.generateVisualMatchExercises(t),this.generateFillBlankExercises(t),this.generateMultipleChoiceExercises(t)]),l=[...s,...a,...i];return 0===l.length&&c("No exercises could be generated - species data may be missing or insufficient"),l.sort(()=>Math.random()-.5).slice(0,e)}getImageUrl(e){if(e.primaryImageUrl&&e.primaryImageUrl.startsWith("http"))return e.primaryImageUrl;if(e.images&&e.images.length>0){const t=e.images[0];if(t.url&&t.url.startsWith("http"))return t.url}if(e.id){return`${"https://aves-production.up.railway.app"}/api/species/${e.id}/image`}const t=["https://images.unsplash.com/photo-1444464666168-49d633b86797?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1452570053594-1b985d6ea890?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1480044965905-02098d419e96?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=400&h=300&fit=crop"];return t[Math.floor(Math.random()*t.length)]}clearCache(){this.speciesCache=[],this.lastFetch=0}},u=()=>{const[i]=t(),[r,n]=s.useState([]),[x,u]=s.useState(0),[b,f]=s.useState(null),[j,N]=s.useState(!1),[y,v]=s.useState(!1),[w,k]=s.useState(0),[C,S]=s.useState(0),[M,L]=s.useState(0),[E,T]=s.useState(!0),[A,D]=s.useState(null),[B,$]=s.useState(!0),[I,_]=s.useState("quick"),[q,F]=s.useState(i.get("speciesId")||void 0),[U,R]=s.useState(),[O,W]=s.useState(),z=s.useRef(null),K=s.useRef(Date.now()),{recordReview:P,calculateQuality:X,isRecording:V,stats:Q}=l();s.useEffect(()=>{(async()=>{try{T(!0),D(null);const e=await p.generateMixedExercises(30);if(0===e.length)return void D("No exercises available. Please ensure species data with images is loaded.");n(e)}catch(e){o("Failed to load exercises",e instanceof Error?e:{error:e}),D("Failed to load practice exercises. Please try again later.")}finally{T(!1)}})()},[]);const H=s.useCallback(()=>0===r.length?null:r[x%r.length],[r,x]),Z=s.useCallback(()=>{f(null),N(!1),u(e=>e+1),K.current=Date.now()},[]),G=s.useCallback(async e=>{f(e);const t=H();if(!t)return;const s=e.toLowerCase()===t.correctAnswer.toLowerCase(),a=Date.now()-K.current;if(v(s),N(!0),S(e=>e+1),s?(k(e=>e+1),L(e=>e+1)):L(0),t.termId||t.speciesId)try{const e=X(s,a);await P({termId:t.termId||`species-${t.speciesId}`,quality:e,responseTimeMs:a})}catch(i){c("Failed to record SRS review",{error:i})}z.current&&clearTimeout(z.current),z.current=setTimeout(()=>{Z()},2e3)},[H,Z,X,P]),Y=s.useCallback(()=>{const t=H();return t?e.jsx(m,{type:t.type,question:t.question,imageUrl:t.imageUrl,translation:t.translation,options:t.options,selectedAnswer:b,correctAnswer:t.correctAnswer,showFeedback:j,explanation:t.explanation,onAnswer:G}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No exercises available"})},[H,b,j,G]),J=s.useMemo(()=>C>0?Math.round(w/C*100):0,[w,C]);s.useEffect(()=>()=>{z.current&&clearTimeout(z.current)},[]);const ee=s.useCallback(()=>{$(!1),T(!0),n([]),u(0),k(0),S(0),L(0),K.current=Date.now()},[]);return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Practice Exercises"}),e.jsxs("div",{className:"flex gap-3",children:[!B&&e.jsx("button",{onClick:()=>$(!0),className:"text-gray-600 hover:text-gray-800 font-medium",children:"Change Mode"}),e.jsx(a,{to:"/learn",className:"text-blue-600 hover:text-blue-800 font-medium",children:"â† Back to Learn"})]})]}),!B&&e.jsx(d,{score:w,accuracy:J,streak:M,totalAttempts:C,srsStats:Q,isRecording:V})]}),B&&e.jsxs("div",{className:"mb-8",children:[e.jsx(g,{selectedMode:I,onModeSelect:_,selectedSpeciesId:q,onSpeciesSelect:F,selectedDifficulty:U,onDifficultySelect:R,selectedType:O,onTypeSelect:W}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:ee,className:"px-8 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors shadow-lg",children:"Start Practice"})})]}),E&&e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading practice exercises..."}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Fetching bird species with images"})]}),A&&!E&&e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-12 text-center",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Unable to Load Exercises"}),e.jsx("p",{className:"text-gray-600 mb-4",children:A}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]}),!E&&!A&&r.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("span",{className:"inline-block px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium",children:H()?.type.replace("_"," ").toUpperCase()}),e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["Exercise ",x+1," of ",r.length]})]}),Y(),j&&H()&&e.jsx(h,{isCorrect:y,correctAnswer:H().correctAnswer}),!j&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:Z,className:"text-gray-500 hover:text-gray-700",children:"Skip this exercise â†’"})})]}),M>=5&&e.jsx("div",{className:"mt-6 bg-gradient-to-r from-yellow-400 to-orange-500 text-white p-4 rounded-lg text-center",children:e.jsxs("p",{className:"text-lg font-bold",children:["ðŸ”¥ You're on fire! ",M," in a row!"]})}),C>0&&C%10==0&&e.jsx("div",{className:"mt-6 bg-gradient-to-r from-purple-500 to-pink-500 text-white p-4 rounded-lg text-center",children:e.jsxs("p",{className:"text-lg font-bold",children:["ðŸŽ‰ Milestone: ",C," exercises completed!"]})})]})]})})};export{u as EnhancedPracticePage};
